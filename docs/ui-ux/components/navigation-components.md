# 네비게이션 컴포넌트 (Navigation Components)

## 개요

앱 전체의 탐색과 네비게이션을 담당하는 컴포넌트들의 기능 요구사항과 사용자 경험을 정의합니다.

## 글로벌 사이드바 (GlobalSidebar)

### 기능 목적
- 데스크톱에서 주요 탭 간 빠른 전환
- 시각적으로 현재 위치 표시
- 미니멀한 디자인으로 공간 효율성 확보

### 레이아웃 구조

#### 기본 사이즈
- 너비: 60px (고정)
- 높이: 전체 화면 높이
- 위치: 화면 왼쪽 고정

#### 탭 아이콘 배치
```
┌──────┐
│ 🏠   │ 홈
├──────┤
│ 💼   │ 워크스페이스
├──────┤
│ 📊   │ 나의 활동
├──────┤
│ 👤   │ 프로필
└──────┘
```

### 시각적 디자인

#### 기본 상태
- 배경색: 짙은 회색 (#1F2937)
- 아이콘 색상: 연한 회색 (#9CA3AF)
- 아이콘 크기: 24px

#### 선택된 탭
- 아이콘 색상: 기본 색상 (#2563EB)
- 배경: 연한 파란색 배경 (#EBF8FF)
- 왼쪽 테두리: 3px 파란색 강조선

#### 호버 상태
- 배경색: 약간 밝은 회색 (#374151)
- 부드러운 전환 애니메이션 (200ms)

### 상호작용

#### 클릭 동작
- 해당 탭으로 즉시 전환
- 네비게이션 상태 업데이트
- 스크롤 위치 초기화 (선택사항)

#### 키보드 네비게이션
- Tab 키로 순차 이동
- Enter/Space로 선택
- 숫자 키 1-4로 직접 이동

#### 접근성
- ARIA 라벨 제공
- 스크린 리더 호환
- 키보드 포커스 표시

### 알림 배지

#### 읽지 않은 알림
- 위치: 아이콘 우상단
- 크기: 16px 원형
- 색상: 빨간색 (#EF4444)
- 텍스트: 흰색 숫자

#### 배지 표시 조건
- 홈: 전체 미읽음 알림 수
- 워크스페이스: 모든 그룹 미읽음 합계
- 나의 활동: 새로운 반응/댓글
- 프로필: 시스템 알림

#### 최대 표시 수
- 99개까지 숫자 표시
- 100개 이상 시 "99+" 표시
- 1000개 이상 시 "999+" 표시

---

## 모바일 워크스페이스 네비게이터

### 기능 목적
- 모바일에서 워크스페이스 내 탐색
- 채널/멤버/설정 간 효율적 전환
- 화면 공간 최적화

### 표시 조건

#### 자동 표시
- 워크스페이스 첫 진입 시
- 뒤로가기 버튼 누를 때
- 메뉴 버튼 탭할 때

#### 자동 숨김
- 채널 콘텐츠 스크롤 시
- 게시글 작성 시작 시
- 댓글 사이드바 열림 시

### 탭 구성

#### 3개 주요 탭
```
[📝 채널] [👥 멤버] [⚙️ 설정]
```

#### 채널 탭
**채널 목록**
- 공지사항 (항상 최상단, 고정 표시)
- 일반 채널들 (생성 순서)
- 즐겨찾기 채널 (⭐ 표시)

**채널 상태 표시**
- 읽지 않은 메시지 수 배지
- 현재 선택된 채널 강조
- 새 메시지 실시간 업데이트

**채널 액션**
- 탭: 해당 채널로 이동
- 길게 누르기: 채널 옵션 메뉴
- 스와이프: 즐겨찾기 토글

#### 멤버 탭
**멤버 목록**
- 온라인 멤버 우선 표시
- 역할별 그룹핑 (오너 > 스태프 > 멤버)
- 프로필 이미지 + 이름 + 상태

**상태 표시**
- 온라인: 녹색 점
- 오프라인: 회색 점
- 부재중: 노란색 점
- 방해금지: 빨간색 점

**멤버 액션**
- 탭: 프로필 카드 표시
- 길게 누르기: 빠른 액션 (DM, 멘션 등)

#### 설정 탭
**그룹 정보**
- 그룹명, 설명, 멤버 수
- 내 역할 및 권한 표시
- 그룹 통계 (활동량, 가입일 등)

**빠른 설정**
- 알림 설정
- 그룹 즐겨찾기
- 그룹 나가기

**관리 기능** (권한별)
- 멤버 관리 (스태프 이상)
- 채널 관리 (스태프 이상)
- 그룹 설정 (오너만)

### 애니메이션

#### 슬라이드 전환
- 하단에서 위로 슬라이드 인
- 위에서 아래로 슬라이드 아웃
- 전환 시간: 300ms
- 이징: ease-out

#### 탭 전환
- 좌우 스와이프로 탭 변경
- 인디케이터 애니메이션
- 내용 영역 페이드 전환

### 제스처 지원

#### 스와이프 제스처
- 좌우 스와이프: 탭 전환
- 아래로 스와이프: 네비게이터 닫기
- 위로 스와이프: 네비게이터 고정

#### 터치 최적화
- 최소 터치 영역: 44px
- 터치 시작점에서 정확한 반응
- 스크롤과 탭의 명확한 구분

---

## 앱바 시스템

### 데스크톱 앱바

#### 구성 요소
```
[뒤로가기] [제목 영역_______________] [알림]
```

#### 뒤로가기 버튼
**표시 조건**
- 홈 탭 기본 상태에서만 숨김
- 나머지 모든 상태에서 표시
- 중첩된 네비게이션에서 필수

**동작 로직**
- 이전 화면으로 복귀
- 상태 스택 기반 네비게이션
- 진입점 기억을 통한 정확한 복귀

#### 제목 영역
**동적 제목 표시**
- 기본 모드: 탭 이름 ("홈", "워크스페이스" 등)
- 그룹 탐색: "교내 그룹 탐색"
- 워크스페이스: "그룹명 | 채널명"

**컨텍스트 정보**
- 그룹 탐색 시 설명 텍스트
- 워크스페이스 시 그룹 아이콘
- 브레드크럼 네비게이션

#### 알림 버튼
- 아이콘: 종 모양
- 배지: 읽지 않은 알림 수
- 클릭: 알림 패널 토글

### 모바일 앱바

#### 기본 구조
```
[뒤로가기] [제목_________________] [메뉴] [알림]
```

#### 제목 최적화
- 긴 제목 자동 말줄임 (...)
- 워크스페이스에서 계층 표시
- 탭할 수 있는 제목 (상위로 이동)

#### 액션 버튼들
**메뉴 버튼**
- 현재 페이지 관련 액션
- 워크스페이스: 네비게이터 토글
- 설정 페이지: 추가 옵션

**알림 버튼**
- 데스크톱과 동일한 기능
- 모바일 최적화된 알림 패널

### 상태별 앱바 변화

#### 일반 모드
- 표준 높이 (52px)
- 기본 배경색
- 그림자 있음

#### 스크롤 모드
- 내용 스크롤 시 자동 숨김
- 위로 스크롤 시 자동 표시
- 부드러운 애니메이션

#### 검색 모드
- 검색창으로 전환
- 취소 버튼 추가
- 검색 결과에 따른 제목 변화

---

## 네비게이션 상태 관리

### NavProvider

#### 상태 관리 범위
- 현재 선택된 탭 인덱스
- 네비게이션 히스토리 스택
- 뒤로가기 가능 여부

#### 주요 메서드
```dart
class NavProvider extends ChangeNotifier {
  int _currentIndex = 0;
  List<int> _navigationStack = [0];

  void setIndex(int index);
  void pushIndex(int index);
  bool canGoBack();
  void goBack();
}
```

### 네비게이션 히스토리

#### 스택 관리
- 탭 전환 시 스택에 추가
- 최대 스택 깊이: 10
- 중복 제거 로직

#### 뒤로가기 동작
- 스택 기반 이전 위치 복원
- 진입점 기억을 통한 크로스 탭 네비게이션
- 앱 시작점까지 뒤로가기 제한

### 딥링킹 지원

#### URL 구조
```
/home                    # 홈 탭
/workspace               # 워크스페이스 목록
/workspace/{groupId}     # 특정 워크스페이스
/workspace/{groupId}/channel/{channelId}  # 특정 채널
/activity                # 나의 활동
/profile                 # 프로필
```

#### 상태 복원
- URL에서 네비게이션 상태 추출
- 필요한 데이터 사전 로딩
- 오류 시 기본 페이지로 폴백

---

## 반응형 네비게이션

### 브레이크포인트별 동작

#### 모바일 (< 768px)
- 하단 네비게이션 바
- 전체화면 모달
- 스와이프 제스처

#### 태블릿 (768px - 899px)
- 하단 네비게이션 바 유지
- 사이드바 형태 네비게이터
- 터치 + 마우스 하이브리드

#### 데스크톱 (≥ 900px)
- 좌측 고정 사이드바
- 상단 앱바
- 키보드 단축키

### 전환 애니메이션

#### 탭 전환
- 페이드 인/아웃
- 슬라이드 전환 (방향성 있는 경우)
- 크로스 페이드

#### 모달 전환
- 하단에서 슬라이드 업
- 배경 딤 애니메이션
- 스프링 이징

#### 로딩 상태
- 스켈레톤 UI
- 프로그레스 바
- 스피너 애니메이션

---

## 접근성 및 사용성

### 키보드 네비게이션

#### 단축키
- Tab: 다음 요소로 이동
- Shift+Tab: 이전 요소로 이동
- Enter/Space: 선택
- Esc: 취소/닫기
- 화살표: 방향 이동

#### 커스텀 단축키
- 1-4: 메인 탭 직접 이동
- Ctrl+F: 검색
- Ctrl+K: 명령 팔레트
- Alt+←: 뒤로가기

### 스크린 리더 지원

#### ARIA 라벨
- 네비게이션 역할 명시
- 현재 위치 안내
- 상태 변화 알림

#### 의미론적 HTML
- nav 요소 사용
- 적절한 헤딩 구조
- 랜드마크 역할

### 국제화

#### 텍스트 현지화
- 네비게이션 라벨
- 툴팁 메시지
- 오류 메시지

#### 문화적 고려
- 읽기 방향 (LTR/RTL)
- 색상 의미
- 아이콘 이해도

---

## 성능 최적화

### 렌더링 최적화

#### 가상화
- 긴 목록의 가상 스크롤
- 뷰포트 기반 렌더링
- 메모리 사용량 최적화

#### 메모화
- 불변 데이터 캐싱
- 계산 결과 메모화
- 렌더링 스킵 조건

### 네트워크 최적화

#### 데이터 프리페칭
- 다음 탭 데이터 미리 로딩
- 백그라운드 동기화
- 오프라인 캐싱

#### 이미지 최적화
- 적응형 이미지 크기
- WebP 형식 지원
- 지연 로딩

---

## 관련 구현 파일

### 네비게이션 컴포넌트
- `frontend/lib/presentation/widgets/global_sidebar.dart`
- `frontend/lib/presentation/screens/main/main_nav_scaffold.dart`

### 상태 관리
- `frontend/lib/presentation/providers/nav_provider.dart`
- `frontend/lib/presentation/providers/ui_state_provider.dart`

### 모바일 네비게이터
- `frontend/lib/presentation/screens/workspace/components/mobile_workspace_navigator.dart`

### 관련 문서
- [메인 네비게이션 페이지](../pages/main-navigation-pages.md)
- [워크스페이스 페이지](../pages/workspace-pages.md)
- [반응형 레이아웃](../responsive-layout.md)