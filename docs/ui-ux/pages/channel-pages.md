# UI/UX 명세서: 채널 페이지

본 문서는 워크스페이스의 핵심 소통 공간인 채널의 생성, 탐색, 상호작용 및 권한 구성(Permission-Centric 매트릭스)을 정의합니다.

## 1. 기본 채널 정책 (rev5 하이브리드)
- 그룹(워크스페이스) 생성 시 **기본 2채널** 자동 생성: 공지(ANNOUNCEMENT), 자유(TEXT)
- 이 2채널만 초기 템플릿 권한 바인딩(그룹장/교수/멤버) 자동 부여
- 이후 **사용자 정의 채널(모든 추가 생성 채널)** 은 권한 바인딩 0개로 시작 → 생성 직후 즉시 권한 매트릭스 설정 필요
- 기본 채널을 삭제 후 재생성하면 “사용자 정의 채널”로 취급되어 0개 바인딩 시작

### 1.1 빈 상태(Empty State) UI (채널 없음 시)
| 조건 | 표시 UI |
|------|---------|
| 채널 0개 & 생성 권한 있음 | “채널을 생성하여 협업을 시작하세요” + [채널 만들기] + 권한 설정 가이드 링크 |
| 채널 0개 & 생성 권한 없음 | “아직 공개된 채널이 없습니다. 권한자에게 문의하세요.” |

## 2. 채널 생성 플로우 (사용자 정의 채널)
### 2.1 생성 모달
필드: 이름(필수), 설명(선택), 타입(TEXT/ANNOUNCEMENT/FILE_SHARE)
버튼: [생성] / [취소]

### 2.2 생성 결과 & 권한 배너
- 저장 직후: 채널 객체만 생성, 권한 바인딩 0개
- 메인 패널 상단 고정 배너 예: “이 채널은 아직 어떤 역할에도 공개되지 않았습니다. 권한을 설정하세요.”
  - [권한 설정 바로가기] 버튼 → 권한 탭 이동

### 2.3 권한 매트릭스 편집 (필수 최소 조건)
검증(저장 활성 조건):
1. CHANNEL_VIEW 최소 1개 역할
2. POST_WRITE / COMMENT_WRITE / FILE_UPLOAD 선택적 (없어도 저장 가능)
권장 경고(Soft): POST_WRITE 선택 시 POST_READ/CHANNEL_VIEW 미선택 역할 강조

### 2.4 저장 후 상태
| 항목 | 저장 전 | 저장 후 |
|------|---------|---------|
| 채널 목록 가시성 | 생성자만 UI 경로로 접근 (직접 URL) | CHANNEL_VIEW 부여된 역할에게 노출 |
| 읽기 | 불가 | POST_READ 부여 역할 가능 |
| 쓰기/댓글 | 불가 | POST_WRITE / COMMENT_WRITE 부여 역할 가능 |

> 기본 초기 2채널은 이 플로우를 건너뛰고 즉시 사용 가능(템플릿 적용)하나, 동일 매트릭스 UI로 재구성 가능.

## 3. 권한 편집 (Permission-Centric 매트릭스)
- 행: CHANNEL_VIEW, POST_READ, POST_WRITE, COMMENT_WRITE, FILE_UPLOAD
- 열: 역할 (동적)
- 검증 규칙:
  - POST_WRITE ⊆ POST_READ ⊆ CHANNEL_VIEW
  - COMMENT_WRITE ⊆ POST_READ
  - FILE_UPLOAD ⊆ POST_WRITE (현 정책)
- 템플릿 빠른 적용 옵션(공지형/토론형/운영전용) 제공 (미구현 시 회색 처리)
> 사용자 정의 채널은 모든 행이 비어있는 상태로 시작. ‘필수: CHANNEL_VIEW ≥ 1’ 배너 + 비활성 [저장] → 조건 충족 시 활성화.

## 4. 채널 메인 뷰

### 4.1 헤더
- 좌측: `#` + 채널 이름, 아래 설명 (툴팁: 전체 표시)
- 우측: [권한 관리] (⚙️) 버튼 (can_manage=true 또는 CHANNEL_MANAGE 보유자만)

### 4.2 콘텐츠 영역

#### 4.2.1. 게시글 목록 (날짜 그룹화 및 Sticky Header)

게시글 목록은 **날짜 기준**으로 그룹화되어 표시되며, 스크롤 시 사용자 경험을 향상시키는 **Sticky Header** UI가 적용됩니다.

-   **날짜 구분선**: 각 날짜 그룹의 시작점에는 `오늘`, `어제` 또는 `YYYY년 MM월 DD일` 형식의 날짜 구분선이 표시됩니다.
-   **Sticky 동작**: 사용자가 목록을 위로 스크롤하면, 현재 보이는 게시글 그룹의 날짜 구분선이 화면 상단에 고정됩니다. 이 구분선은 다음 날짜 그룹의 구분선이 나타나기 전까지 상단에 머무르며, 현재 보고 있는 게시글의 날짜 컨텍스트를 명확하게 제공합니다.
-   **스크롤 방향**: 사용자는 목록의 가장 아래(최신 게시글)에서 시작하여 위로 스크롤하며 과거의 게시글을 탐색합니다. 목록의 상단에 도달하면 이전 페이지의 게시글이 자동으로 로드됩니다.

상태별:
| 상태 | UI |
|------|----|
| 게시글 없음 + 읽기 권한 있음 | Empty 메시지 + "첫 글을 작성해보세요" (쓰기 권한 존재 시 버튼) |
| 읽기 권한 없음 | 중앙 정렬 안내: "이 채널을 볼 권한이 없습니다" + 권한 요청 안내 |
| 쓰기 권한 없음 | 입력창 disabled, placeholder: "쓰기 권한이 없습니다" |

### 4.3 입력창 권한 처리
- POST_WRITE 권한 보유 → 활성
- COMMENT_WRITE 권한만 보유 & 글 작성 권한 없음 → 댓글만 가능 (게시글 상세에서)
- 파일 첨부 버튼은 FILE_UPLOAD 권한자만 표시/활성

## 5. 에러 & 피드백 패턴
| 상황 | 메시지 | 처리 |
|------|--------|------|
| 권한 저장 시 검증 실패 | "POST_WRITE 권한은 읽기 권한 역할에만 부여할 수 있습니다" | 행 강조 + 툴팁 |
| 저장 중 네트워크 오류 | "권한 저장에 실패했습니다. 다시 시도하세요" | 재시도 버튼 |
| 채널 접근 403 | "채널 권한이 제거되었을 수 있습니다" | 뒤로가기 + 새로고침 CTA |

## 6. 접근성 고려
- 매트릭스: 키보드 Tab 순서 행 우선 → Space/Enter 토글
- 역할 태그: aria-pressed 속성 활용
- 오류 표시: role=alert

## 관련 문서
- 개념: ../../concepts/channel-permissions.md
- 권한 시스템: ../../concepts/permission-system.md
- 워크스페이스: ../../concepts/workspace-channel.md
- 트러블슈팅: ../../troubleshooting/permission-errors.md
