# 전역 예외 처리 및 로깅 전력

### 1. 핵심 전략: 예외와 로그의 중앙 관리

모든 예외는 **`@RestControllerAdvice`**를 사용하는 '전역 예외 핸들러'에서 중앙 처리하며, 이 과정에서 발생하는 중요한 에러 로그 또한 예외 핸들러에서 통합적으로 기록합니다. 이 전략은 비즈니스 로직 코드의 단순성과 시스템 전체의 일관성을 확보하는 것을 목표로 합니다.

### 2. 전역 예외 처리 (Global Exception Handling)

### **2.1. 구현 방식**

1. **커스텀 예외 중앙 관리:** 서비스에서 발생할 수 있는 모든 예측 가능한 비즈니스 예외 상황(예: 사용자를 찾을 수 없음, 권한 없음)은 **`ErrorCode` enum 클래스**에서 고유 코드와 메시지로 중앙 관리합니다. 실제 예외는 이 `ErrorCode`를 담는 **`BusinessException`** 클래스를 통해 발생시킵니다.
2. **Service 계층의 역할:** 비즈니스 로직을 수행하다 예외 상황이 발생하면, `Service`는 미리 정의된 `BusinessException`을 발생시키는(`throw`) 역할만 담당합니다.
3. **`@RestControllerAdvice`의 역할:** '전역 예외 핸들러'가 `BusinessException`을 포함한 모든 예외를 자동으로 감지하여, 우리가 API 설계 원칙에서 정의한 **표준 에러 JSON 형식**으로 변환 후 사용자에게 응답합니다.

### **2.2. 유효성 검사(@Valid) 실패 처리**

- `Controller`의 DTO 형식 검증(@Valid)에 실패하여 발생하는 `MethodArgumentNotValidException`은 예외 핸들러에서 별도로 감지합니다.
- **HTTP 400 상태 코드**와 함께, 표준 에러 형식(`"code": "COMMON_001"`)으로 응답을 내려줍니다.

---

### 3. 로깅 전략 (Logging Strategy)

안정적인 서비스 운영을 위한 최소한의 로깅 규칙을 정의합니다. 복잡한 설정 없이 Spring Boot의 표준 기술(SLF4J + Logback)을 최대한 활용합니다.

### **3.1. 환경별 로그 레벨 설정**

- **개발 환경 (local, dev):** **`DEBUG`** 레벨로 설정하여 개발에 필요한 상세 정보를 모두 기록합니다.
- **운영 환경 (production):** **`INFO`** 레벨로 설정하여, 불필요한 로그로 인한 성능 저하를 막고 핵심 정보와 에러만 기록합니다.

### **3.2. 로그 형식 및 내용**

- **로그 형식:** **일반 텍스트 형식**의 로그를 사용합니다. (JSON 로그는 MVP에서 제외)
- **API 로깅:** 모든 API 요청에 대해 **요청 URL과 HTTP Method**만 `INFO` 레벨로 기록하여 디버깅 단서를 확보합니다. (보안을 위해 요청/응답 본문 전체는 기록하지 않음)
- **로그 내용 원칙:**
    - **`INFO`**: 서버 시작, 주요 기능 성공 등 핵심적인 정보성 로그
    - **`WARN`**: 심각하진 않지만 주의가 필요한 잠재적 문제
    - **`ERROR`**: 예외 핸들러에서 감지된 모든 예외. 특히 예측하지 못한 500 에러의 경우, **반드시 스택 트레이스(stack trace)를 포함**하여 기록해야 원인 분석이 가능합니다.

### **3.3. 로그 파일 관리**

- **로그 로테이션:** **매일 자정**에 새로운 로그 파일이 생성되도록 설정합니다.
- **보관 주기:** 서버 디스크 용량 관리를 위해, 생성된 로그 파일은 **최대 30일까지만 보관**하고 오래된 파일은 자동으로 삭제합니다.