# 관리자 페이지 UI·UX 명세서 (Toss 철학 적용 · Flutter/Spring Boot) v1.0

> 목적: 관리자가 **해야 할 일을 한 눈에 보고, 3클릭 안에 처리**하게 한다. 원칙: 한 화면=한 목표 · 가치 먼저 · 에러는 다음으로 안내 · 일관성(토큰/컴포넌트).

---

## 0. Design Principles (요약)
- **한 화면 = 한 목표**: 관리 홈=다음 행동 인지, 각 세부 화면=설정/결정 1건 완료.
- **가치 먼저**: "가입 대기 N명"·"역할 X개"·"채널 Y개" 같은 **실행 신호**를 카드에서 바로 노출.
- **가드레일**: 파괴적 행위(삭제/위임)는 **영향 요약 + 재확인 + Undo(가능 시)**.
- **일관성**: 카드/배지/토스트/모달/Empty/스켈레톤/토글/드롭다운/바텀시트를 공용 패턴으로.
- **톤 & 매너**: 짧고 친근, 결과 선언형("저장했어요", "삭제했어요").

---

## 1. 범위 & KPI
- **범위(MVP)**: 관리 홈 · 멤버 관리(가입 대기 배지) · 역할 관리 · 채널 관리 · 지도교수 관리(그룹장 한정) · 그룹 정보 수정 · 그룹 삭제(위험영역).
- **KPI**
  - 관리 홈 진입→첫 작업 완료 **p50 ≤ 30s**
  - 가입 대기 처리 평균 **≤ 5s** (홈→대기 탭→승인/반려)
  - 잘못된 설정/삭제로 인한 롤백률 **< 1%**

---

## 2. 접근 정책 & 페르소나
- **접근**: 하나 이상의 **관리 권한 보유자**에게만 헤더의 [관리] 버튼 노출. 버튼 탭→**관리 홈** 진입.
- **표시 규칙**: 사용자가 가진 **권한의 메뉴만 노출**(예: 모집/멤버/채널/역할/지도교수/그룹 정보/삭제).
- **페르소나**
  - 그룹장(Owner) / 지도교수(Professor) / 스태프(Staff) / 일반 멤버(Member)

---

## 3. 정보 구조 & 라우팅(IA)
- **관리 홈** `/groups/:id/admin`  
  → **멤버 관리** `/groups/:id/admin/members?tab=pending|current`  
  → **역할 관리** `/groups/:id/admin/roles`  
  → **채널 관리** `/groups/:id/admin/channels`  
  → **지도교수 관리** `/groups/:id/admin/advisors` *(그룹장만)*  
  → **그룹 정보 수정** `/groups/:id/admin/settings`  
  → **그룹 삭제**(바텀시트)

---

## 4. 상태 모델(State Model)
- **Permissions**: `canManageMembers`, `canManageRoles`, `canManageChannels`, `isOwner`(그룹장), `canManageAdvisors`(그룹장 전용)
- **Stats**: `pendingCount`, `memberCount`, `roleCount`, `channelCount`
- **Danger Ops**: `deleteGroup(state: idle|confirming|processing|done)`

---

## 5. 화면 설계 (Screens)
### A) 관리 홈 — *다음 행동을 즉시 인지*
- **헤더**: "어떤 관리를 도와드릴까요?"
- **카드 리스트 (권한 기반 노출)**
  1. **멤버 관리** — 보조문구: *N명이 가입을 기다리고 있어요* **[대기 보기]** 배지  
     탭→ 멤버 관리(대기 탭으로 딥링크)
  2. **역할 관리** — 보조문구: *그룹의 역할과 권한을 설정해요*
  3. **채널 관리** — 보조문구: *멤버들이 대화할 채널을 만들고 설정해요*
  4. **지도교수 관리** *(그룹장에게만)* — 보조문구: *지도교수님을 추가/해제해요*
  5. **그룹 정보 수정** — 보조문구: *그룹 이름·설명·태그를 바꿔요*
  6. **그룹 삭제(위험 영역)** — 카드는 하단 고정, 레드 아이콘/문구
- **빈/로딩/에러**
  - 로딩: 각 카드에 스켈레톤(타이틀/보조 2줄)
  - 에러: "관리 정보를 불러오지 못했어요" [다시 시도]

### B) 멤버 관리 — *요약*
- 탭: **현재 멤버 | 가입 대기**  
  (대기는 카드형 [거절][승인], 현재 멤버는 행형 [역할 변경/강제 탈퇴/그룹장 위임])
- 홈의 **[대기 보기]**를 탭하면 해당 탭으로 진입.

### C) 역할 관리 — *한 화면 설정*
- **역할 목록** + **[+ 역할 추가]**
- **역할 생성/수정 폼(단일 화면)**: 역할명(TextField) + 권한 토글(모집/멤버/채널 관리)
- **저장**: [저장] 탭→ 토스트 "저장했어요" + 목록으로
- **역할 삭제**: … → [삭제] → **영향 요약 모달**(보유자 X명→일반 멤버) → [삭제] → 스낵바 Undo(5초)

### D) 채널 관리 — *고민 없는 설정*
- **채널 목록** + **[+ 채널 추가]**
- **채널 생성/수정 폼(단일 화면)**: 채널명 · 설명 · **열람 가능 역할**(다중 선택) · **작성 가능 역할**(다중 선택)
- **삭제**: 확인 모달(게시물/댓글 영향 안내)

### E) 지도교수 관리 *(그룹장 전용)*
- **목록**: 교수 아바타/이름/이메일 · [해제]
- **추가**: [교수 추가] → 이메일/검색 → 결과에서 선택 → [추가]
- **해제**: 확인 모달 → 토스트 "해제했어요"

### F) 그룹 정보 수정 — *즉시 반영*
- **필드**: 이름, 설명, 카테고리/태그, 대표 이미지(선택)
- **저장**: [저장] → 토스트 "저장했어요"

### G) 그룹 삭제 — *위험 영역*
- 트리거: 관리 홈 하단 카드 → **바텀 시트** 등장
- **경고 요약**: "그룹을 없애면 되돌릴 수 없어요"  
  🗑️ 채널 N개/게시물 수, 👥 멤버 N명  
- **입력 재확인**: 그룹 이름 정확히 입력해야 [그룹 삭제하기] 활성화
- **실행**: [그룹 삭제하기] (Danger) → 진행 인디케이터 → 성공 시 홈으로 이동/로그아웃(옵션)

---

## 6. 컴포넌트 & 위젯 사양(Flutter)
- `AdminCard({icon, title, subtitle, badgeText?, onTap})`
- `StatBadge({text})` — 예: "대기 3"
- `RoleEditorForm({name, flags:{manageRecruit,manageMembers,manageChannels}, onSave, onDelete})`
- `ChannelEditorForm({name, description, readRoles[], writeRoles[], onSave, onDelete})`
- `AdvisorList({items, onAdd, onRemove})` + `AdvisorAddDialog({onSearch, onSelect, onConfirm})`
- `GroupSettingsForm({name, description, tags[], image?, onSave})`
- `DangerZoneCard({title, description, confirmText, onConfirm})`
- `ConfirmDangerDialog({title, description, confirmLabel, onConfirm})`
- `PolicyImpactModal({title, impacts[], onConfirm})` — 역할 삭제/채널 삭제 등에 재사용

**디자인 토큰**
- 카드 패딩 16dp, 코너 12dp, 섹션 간격 24dp, 그리드 4dp
- 타이포: H1 24/32, H2 20/28, Body 16/24, Caption 13/18
- 컬러: Primary/Success/Warning/Danger(삭제)
- 모션: 전환 200–250ms, 모달 180ms, 토스트 2.5s

---

## 7. 마이크로카피 (Toss 톤)
- 관리 홈 헤더: **"어떤 관리를 도와드릴까요?"**
- 멤버 대기 배지: **"대기 {n}"**
- 역할 저장: **"저장했어요"** / 삭제: **"역할을 삭제했어요"** *(Undo 제공)*
- 채널 저장: **"저장했어요"** / 삭제: **"채널을 삭제했어요"**
- 지도교수 추가: **"추가했어요"**, 해제: **"해제했어요"**
- 그룹 정보: **"저장했어요"**
- 그룹 삭제: **"그룹을 삭제했어요"**
- 오류 공통: **"요청을 처리하지 못했어요. 다시 시도해 주세요"**

---

## 8. 검증 규칙 & 가드레일
- **권한 기반 노출**: 사용 권한 없는 카드는 렌더링하지 않음(링크 차단 포함)
- **필수값 검증**: 역할/채널/그룹 설정 폼은 즉시 인라인 검증(빈 문자열, 중복 이름 등)
- **충돌 처리**: 동시 편집 409 → "이미 변경되었어요. 새로고침했어요"
- **파괴적 행위**: 삭제 전 **영향 요약** 표시, 실행 후 5초 Undo(가능 시)
- **그룹 삭제**: 이름 정확 입력 전까지 버튼 비활성

---

## 9. 이벤트 & 계측(Analytics)
- 홈: `admin_home_view`, `admin_card_click(type)`, `admin_stats_fetch`
- 멤버: `admin_members_open(tab)`, `pending_approve/reject`
- 역할: `role_create/save/delete`, `role_delete_undo`
- 채널: `channel_create/save/delete`
- 지도교수: `advisor_add/search/remove`
- 그룹 정보: `group_settings_save`
- 삭제: `group_delete_open/confirm/cancel`

---

## 10. API 연동(UX 관점)
- **GET /groups/{id}/admin/stats** → `{pendingCount, memberCount, roleCount, channelCount}`
- **권한 확인**: `/auth/me` 또는 `/groups/{id}/me/permissions`
- **멤버/역할/채널**: 기존 엔드포인트 재사용(역할 생성/토글, 채널 CRUD)
- **지도교수**: `GET/POST/DELETE /groups/{id}/advisors`
- **그룹 정보**: `GET/PATCH /groups/{id}`
- **그룹 삭제**: `DELETE /groups/{id}` (이름 재확인 토큰 포함)

---

## 11. 텍스트 와이어프레임
### 11.1 관리 홈
```
어떤 관리를 도와드릴까요?
[👥 멤버 관리]    대기 3
그룹 멤버를 승인/반려하고 역할을 바꿔요

[🏷 역할 관리]
그룹의 역할과 권한을 설정해요

[＃ 채널 관리]
멤버들이 대화할 채널을 만들고 설정해요

[🎓 지도교수 관리]  (그룹장만)
지도교수님을 추가/해제해요

[🛠 그룹 정보 수정]
그룹 이름·설명·태그를 바꿔요

[🗑 그룹 삭제]
삭제하면 되돌릴 수 없어요
```

### 11.2 역할/채널 편집(단일 화면)
```
역할 이름  [__________]
권한       [모집관리 ▢] [멤버관리 ▢] [채널관리 ▢]
             [ 저장 ]        […]

채널 이름  [__________]
설명       [__________]
열람 가능  [모두 ▢] [역할 선택 ▢]
작성 가능  [모두 ▢] [역할 선택 ▢]
             [ 저장 ]        […]
```

### 11.3 그룹 삭제 바텀시트
```
정말 그룹을 없애시겠어요?
그룹을 없애면 아래 내용이 모두 사라지고 되돌릴 수 없어요.
🗑 채널 5개와 모든 메시지
👥 멤버 42명과의 관계

그룹 이름을 입력해 주세요
[ my-group-name________________ ]

[ 그룹 삭제하기 ](비활성) → 정확히 입력하면 활성
```

---

## 12. 수용 기준(AC)
1) 권한이 없는 메뉴는 **관리 홈에 보이지 않는다**.
2) 관리 홈의 **대기 배지**는 API 응답 기준으로 표시되고, 탭 시 **대기 탭**으로 딥링크한다.
3) 역할/채널 편집은 **단일 화면**에서 이름+권한을 설정하고 **저장 1회**로 완료된다.
4) 삭제류 액션은 **영향 요약**을 반드시 표시하고, 실행 후 토스트를 노출한다.
5) 그룹 삭제는 **이름 재입력 전까지 버튼이 비활성**이며, 실행 중 진행 인디케이터가 표시된다.

---

## 13. 구현 메모(Flutter)
- 페이지: `AdminHomePage` / `MemberAdminPage` / `RoleAdminPage` / `ChannelAdminPage` / `AdvisorAdminPage` / `GroupSettingsPage`
- 상태관리: Riverpod 권장. `adminStatsProvider`, `permissionsProvider`, `roleEditorProvider`, `channelEditorProvider`
- 낙관적 업데이트: 저장/삭제 성공률이 높을 때 적용, 실패 시 Undo 또는 롤백
- 접근성: 카드/버튼 44dp, 배지에 대체 텍스트, 삭제 바텀시트에 스크린리더 힌트
- 성능: 홈 카드 메모이제이션, 스켈레톤 프리렌더, 딥링크시 목적 탭 프리페치

---

## 14. 로드맵(차순위)
- 감사 로그(최근 변경 내역) / 다중 선택 일괄 작업(역할변경/채널권한)
- 관리자 검색창(멤버/역할/채널 통합 검색)
- 설정 검증 리포트(권한 충돌/미사용 채널 감지)

