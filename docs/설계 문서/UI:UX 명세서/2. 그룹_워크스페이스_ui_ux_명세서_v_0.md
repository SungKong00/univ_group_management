# 그룹/워크스페이스 UI·UX 명세서 (Toss 철학 적용 · Flutter/Spring Boot) v0.9

> 본 문서는 "그룹/워크스페이스" 전 구간의 UX를 토스 디자인 철학(한 화면=한 목표, 가치 먼저, 에러는 다음으로 안내, 일관성=토큰/컴포넌트)으로 구체화한 실행 명세입니다. 대상 범위: 그룹 소개/입장, 워크스페이스 탭 구조(공지·채널·멤버), 멤버 승인/관리(관리자), 채널/게시물 기본 동작, 알림 연계.

---

## 0. Design Principles (요약)

- **한 화면 = 한 목표**: 그룹 소개는 ‘가입/입장’, 멤버 관리 화면은 ‘승인/반려’처럼 페이지당 목표를 1개로 명확화.
- **가치 먼저, 비용은 나중**: 비회원에게는 먼저 그룹의 가치(활동/최근 공지)를 보여준 뒤, 가입 신청을 요청.
- **에러는 다음으로 안내**: 권한 부족·비활성 공고 등 에러 상황에서 해결 행동(요청/문의/역할 보기)을 함께 제시.
- **일관성**: 탭/헤더/버튼/배지/토스트/모달/Empty/로딩 패턴을 공통 컴포넌트로 재사용.

---

## 1. 범위 & 목표 (Scope & KPIs)

- **범위**: 그룹 상세(소개/입장) → 워크스페이스 탭(공지·채널·멤버) → 관리자(멤버 승인, 역할/채널 관리 일부) → 알림/모집 연계.
- **KPIs**
  - 그룹 **가입 전환율**: 그룹 상세 진입 대비 가입 신청 완료.
  - **승인 처리 SLA**: 가입 대기 → 승인/반려까지 평균 소요 시간.
  - **채널 활성도**: 채널별 주간 게시/댓글 수, 첫 게시까지 걸린 시간.

---

## 2. 사용자 여정 (User Journey)

### 2.1 엔트리 포인트

- [탐색]에서 그룹 카드 → 그룹 상세(비회원) / 워크스페이스(회원)
- [모집] 공고 상세 → "그룹 페이지로 이동" → 그룹 상세
- 알림 클릭 → 관련 채널/게시물로 딥링크

### 2.2 상태별 핵심 흐름

1. **비회원**: 그룹 가치 확인 → [가입 신청하기] → 대기 상태 배너 → 승인 시 워크스페이스 입장
2. **대기 중**: 상단 배너 "가입 신청이 접수되었어요" → 취소 가능(선택)
3. **멤버**: 워크스페이스 탭(공지·채널·멤버) 접근 가능, 권한에 따라 작성/관리 액션 노출
4. **관리 권한 보유자**(그룹장/지도교수/스태프): 관리자 패널 진입 → 가입 승인/반려, 역할/채널 관리

---

## 3. 정보 구조 & 라우팅 (IA)

- **그룹 상세(비회원)**: Header(그룹명·배지) / 소개 카드 / 하단 CTA("가입 신청하기" 또는 "승인 대기")
- **워크스페이스(회원)**: 
  - **모바일:** 상단 헤더(그룹명·내 역할 배지·관리 버튼\*) + 하단 탭 **공지 | 채널 | 멤버**
  - **데스크톱:** 좌측에 `GlobalSidebar`와 `WorkspaceSidebar`가 고정되며, 메인 컨텐츠 영역에 상단 헤더와 탭(공지 | 채널 | 멤버) 내용이 표시됩니다.
  - \*관리 버튼은 권한 보유자에게만 노출
- **관리자 패널**: 멤버 관리(현재 멤버 / 가입 대기) · 역할 관리(커스텀 역할 권한 토글) · 채널 관리(권한/생성/삭제)

---

## 4. 화면 설계 (Screens)

### G-1. 그룹 상세 (비회원)

- **목표**: 그룹의 가치를 파악하고 가입을 신청.
- **상단**: 그룹명, 카테고리/태그, 멤버 수, 대표 이미지(선택)
- **정책 섹션(선택)**: 가입 기준/활동 빈도/연락 채널 등
- **CTA**: [가입 신청하기] (대기 중이면 [승인 대기 중] 비활성 버튼 + 취소 링크)

### G-2. 워크스페이스 탭 (회원)

- **헤더**: 그룹명 / 내 역할 배지(그룹장·지도교수·스태프·멤버) / [관리]
- **탭**
  - **공지**: 공지 카드 리스트(최신↑). 작성 권한: 그룹장·지도교수(기본). 카드형 읽기 + 고정(핀) 1개 지원.
  - **채널**: 채널 목록(자유, Q&A 등) → 채널 상세(채팅식 피드, 입력창 고정, 파일 첨부). 댓글 1레벨.
  - **멤버**: 멤버 수, 검색, 역할 필터. 행 우측 더보기: (권한 보유자에게) 역할 변경/강제 탈퇴/그룹장 위임.

### G-3. 관리자 > 멤버 관리

- **탭**: 현재 멤버 | 가입 대기
- **현재 멤버**: 아바타/닉네임/역할/가입일/더보기(역할 변경, 강제 탈퇴, (본인일 때) 그룹장 위임)
- **가입 대기**: 지원자 카드(아바타/닉네임/사유/신청일) + [거절] [승인]
- **가드레일**: 본인 역할 변경/해제 불가, 그룹장 행은 역할 드롭다운 비활성

### G-4. 관리자 > 채널 관리 (요약)

- 채널 목록 + [채널 생성]
- 채널별 설정: 이름, 설명, **열람 가능 역할 / 작성 가능 역할** 토글
- 삭제 시 확인 모달(게시물/댓글 영향 안내)

### G-5. 관리자 > 역할 관리 (요약)

- 커스텀 역할 목록 + [역할 생성]
- 권한 토글: 모집 관리 / 멤버 관리 / 채널 관리
- 역할 삭제 시: 해당 역할 보유자 → 일반 멤버로 자동 변경(정보 배너 노출)

---

## 5. 컴포넌트 & 상태 (UI Components & States)

### 공통 헤더

- 좌: 뒤로/탐색으로 / 중앙: 그룹명 / 우: [관리](권한자)
- 서브: 내 역할 배지, (대기 상태 시) 노란색 배너 "가입 신청이 접수되었어요"

### 탭 바

- 3탭(공지/채널/멤버). 현재 탭 하이라이트, 스와이프 이동 허용

### 멤버 리스트 행

- 아바타/닉네임/역할 칩/가입일/…메뉴
- 권한자일 때 …메뉴: 역할 변경(드롭다운), 강제 탈퇴, (본인) 그룹장 위임

### 채널 피드

- 상단: 채널 이름 + 참여자 수
- 본문: 시간순 메시지(최신 하단), 각 메시지에 작성자/시간/본문/리액션/댓글수
- 하단: Composer(텍스트, 파일 첨부), 전송 버튼

### 상태/피드백

- 승인/반려/역할 변경/강제 탈퇴: 상단 토스트 + 알림 트리거
- 빈 상태: 공지 없음/채널 메시지 없음/가입 대기 없음 각각 안내 + 1차 행동 버튼
- 로딩: 스켈레톤(리스트 3\~5줄)

---

## 6. 마이크로카피 (예시)

- 그룹 상세 CTA: "가입 신청하기" / (대기) "승인 대기 중" / (멤버) "그룹 입장하기"
- 멤버 탭 안내: "역할에 따라 할 수 있는 일이 달라져요"
- 승인/반려 토스트: "가입을 승인했어요" / "신청을 반려했어요"
- 역할 변경: "역할을 ‘스태프’로 변경했어요"
- 강제 탈퇴: "멤버를 그룹에서 내보냈어요"
- 채널 빈 상태: "첫 글을 남겨보세요"

---

## 7. 검증 규칙 & 예외 처리

- **가입 신청 중복 방지**: 대기 상태에서는 CTA 비활성 + 취소만 가능
- **역할 변경 제한**: 본인 역할은 변경/해제 불가, 그룹장은 드롭다운 비활성
- **역할 삭제**: 해당 역할 보유자 전원 → 일반 멤버로 자동 변경(토스트+알림)
- **채널 권한**: 열람/작성 불가 시 입력창 비활성 + 안내문구
- **삭제/위임 가드**: 요약 모달에 영향 범위(게시물 수/멤버 수) 표시 → 확인 후 실행

---

## 8. 접근성 & 반응형

- **터치 타깃**: 44dp 이상, 리스트 행 높이 56dp 이상 등 기본적인 접근성 지침을 준수합니다.
- **스크린리더**: 배지, 아이콘 버튼 등에 의미 있는 텍스트를 제공합니다.
- **키보드 네비게이션**: 키보드 포커스 순서를 논리적으로 유지하고, 탭 전환 시 페이지 제목을 라이브 영역으로 갱신합니다.

### 8.1. 반응형 레이아웃 상세

- **분기점(Breakpoint):** 화면 너비 `900px`
- **모바일 뷰 (`< 900px`):**
  - **네비게이션:** 화면 하단의 `BottomNavigationBar`를 통해 `공지`, `채널`, `멤버` 탭으로 이동합니다.
  - **레이아웃:** 전통적인 모바일 단일 화면 레이아웃을 사용합니다.
- **데스크톱 뷰 (`>= 900px`):**
  - **네비게이션:** 화면 좌측의 `GlobalSidebar` (앱 전체 네비게이션)와 `WorkspaceSidebar` (워크스페이스 내부 네비게이션)를 통해 이동합니다.
  - **레이아웃:** **3단 패널(3-Pane) 레이아웃**을 사용합니다.
    1. **글로벌 사이드바 (60px):** 앱의 최상위 메뉴(홈, 워크스페이스 등)가 고정됩니다.
    2. **워크스페이스 사이드바 (200px):** 현재 워크스페이스의 채널 목록 및 관리 메뉴가 고정됩니다.
    3. **메인 컨텐츠:** 선택된 탭(`공지`, `채널`, `멤버`)의 내용이 표시됩니다.

---

## 9. 디자인 토큰(재사용)

- **배지**: 역할/상태 색 구분(Primary/Success/Warning/Danger)
- **리스트 간격**: 행 16dp, 섹션 24dp
- **모션**: 탭 전환 200–250ms, 토스트 2.5s, 확인 모달 페이드 180ms

---

## 10. 이벤트 & 계측 (Analytics)

- group\_view (비회원/회원), join\_apply\_click, join\_apply\_success/fail, join\_cancel
- approval\_decision: approve|reject, approval\_time\_ms
- member\_role\_change, member\_forced\_remove, leader\_delegate
- channel\_open, post\_create, comment\_create, post\_delete\_moderation

---

## 11. API 연동 계약(초안)

- **GET /groups/{groupId}** → 그룹 기본 정보/소개/통계
- **POST /groups/{groupId}/join** → 가입 신청
- **POST /groups/{groupId}/join/cancel** → 신청 취소
- **GET /groups/{groupId}/members?tab=current|pending**
- **POST /groups/{groupId}/members/{memberId}/approve|reject** (사유 포함)
- **POST /groups/{groupId}/roles** (커스텀 역할 생성/권한 토글)
- **PATCH /groups/{groupId}/members/{memberId}/role** (역할 변경)
- **POST /groups/{groupId}/leader/delegate** (그룹장 위임)
- **GET /groups/{groupId}/channels** / **POST /groups/{groupId}/channels** / **DELETE /groups/{groupId}/channels/{channelId}**
- **GET /channels/{channelId}/posts** / **POST /channels/{channelId}/posts**
- **POST /posts/{postId}/comments**

> 에러 코드 예: `E_ROLE_SELF_CHANGE_FORBIDDEN`, `E_PENDING_EXISTS`, `E_CHANNEL_WRITE_FORBIDDEN`, `E_ROLE_DELETE_HAS_MEMBERS`

---

## 12. 플로우 다이어그램(텍스트)

- 비회원: 그룹 상세 → [가입 신청하기] → 상태=대기 → (관리자 승인) → 멤버 → 워크스페이스 탭
- 관리자: 관리자 패널 → 가입 대기 탭 → [승인/거절] → 토스트+알림 → 목록 갱신
- 권한: (멤버 행 …) 역할 변경/강제 탈퇴/그룹장 위임 → 확인 모달 → 토스트+알림

---

## 13. 테스트 시나리오(샘플)

1. 비회원이 그룹 상세에서 가입 신청 → 대기 배너 노출 → 관리자 승인 후 워크스페이스 접근 가능
2. 대기 중 취소 → CTA가 다시 "가입 신청하기"로 전환
3. 관리자: 가입 대기 탭에서 승인/반려 동작 확인(알림/토스트)
4. 역할 변경: 멤버의 역할을 스태프로 변경 → 즉시 반영 + 알림
5. 본인 역할 변경 불가 확인, 그룹장 행 드롭다운 비활성 확인
6. 채널 권한 불가 사용자 → 입력창 비활성 + 안내문구 노출

---

## 14. 구현 메모(Flutter)

- 페이지: `GroupDetailPage(NotMember)` → `WorkspacePage(Member, tabs: Notice/Channels/Members)` → `GroupAdminPage(tabs: Members/Roles/Channels)`
- 위젯: `GroupHeader`, `RoleBadge`, `TabBar3`, `MemberRow`, `OverflowMenu`, `ApproveRejectBar`, `ChannelList`, `PostComposer`, `Toast`, `ConfirmDialog`
- 상태: Riverpod/Bloc 권장. 탭 상태는 보존, 스크롤 상태 기억.

## 15. 구현 메모(Backend)

- 가입 신청 중복 체크/취소 처리, 승인/반려 이벤트 발생 시 알림 트리거
- 기본 채널 생성: 그룹 생성 시 공지/자유 채널 자동 생성
- 역할 삭제 시 멤버 롤백 트랜잭션, 리더 위임 원자성 보장

---

## 16. 와이어프레임 (텍스트)

### 16.1 G-2 워크스페이스(회원) - 모바일

```
[헤더]  그룹명            [관리]
        역할배지

[탭]   공지 | 채널 | 멤버

(공지)
[공지 카드]
[공지 카드]    (없으면 Empty: "첫 공지를 작성해 주세요" [공지 작성])

(채널)
[채널 목록]
  • 공지  • 자유  • Q&A  [+]

[채널 상세: 자유]
(메시지)  프로필  닉네임  본문  시간   [❤️] [댓글 3]
(메시지)
-----------------------------------
[ + 파일 ]  메시지를 입력하세요…        [보내기]

(멤버)
[검색] [역할 필터]
[아바타 닉네임] [역할칩] [가입일]  […]
  → (권한자) 역할변경 / 강제탈퇴 / (본인)그룹장위임
```

### 16.1.1 G-2 워크스페이스(회원) - 데스크톱

```
+----------------+----------------------+------------------------------------------+
| GlobalSidebar  | WorkspaceSidebar     | [헤더] 그룹명                    [관리]    |
| (60px)         | (200px)              |                                          |
|----------------|----------------------|------------------------------------------|
| [🏠 홈]        | [그룹 로고/이름]     | [탭]   공지 | 채널 | 멤버                  |
| [🏢 워크스페이스] | -------------------- |                                          |
| [📜 나의 활동] | # 공지채널           | (채널 선택 시)                           |
| [👤 프로필]     | # 자유채널 (활성)    | [채널 상세: 자유]                        |
|                | # Q&A 채널           | (메시지) 프로필 닉네임 본문 시간 [❤️][💬] |
|----------------| -------------------- | (메시지) ...                             |
| [⚙️ 설정]      | [관리 메뉴 (권한자)] | ---------------------------------------- |
| [🚪 로그아웃]   |                      | [입력창] 메시지를 입력하세요... [보내기] |
+----------------+----------------------+------------------------------------------+
```

### 16.2 G-3 관리자 > 멤버 관리

```
[헤더] 그룹 관리
[탭]  현재 멤버 | 가입 대기

(현재 멤버)
[아바타 닉네임]  [역할 ▼]  [가입일]   […]
(자기행) [역할 ▼](비활성)  […] (그룹장 위임)

(가입 대기)
[신청자 카드]
  프로필  닉네임  신청일  [거절] [승인]

[토스트] 가입을 승인했어요
```

### 16.3 G-1 그룹 상세(비회원)

```
[헤더]  그룹명
[대표 이미지]
[태그/멤버 수]

[최근 공지]  제목/요약  [더 보기]
[최근 활동]  한 줄 하이라이트

[가입 신청하기]
(대기) [승인 대기 중]  [신청 취소]
```

### 16.4 수용 기준(AC)

1. 비회원 상태에서 CTA는 항상 1개(가입 신청/승인 대기/그룹 입장 중 하나)만 노출된다.
2. 관리자 > 가입 대기 탭에서 승인/반려 시 300ms 내 리스트가 갱신되고 토스트가 노출된다.
3. 역할 변경 시 드롭다운 선택 즉시 서버 반영(낙관적 업데이트 가능) 후 실패 시 되돌리기(Undo) 제공.
4. 채널 권한이 없으면 입력창이 비활성화되고 안내문구가 뜬다.
5. 알림 클릭 시 원문(게시물/승인 결과/역할 변경)으로 바로 이동한다.

