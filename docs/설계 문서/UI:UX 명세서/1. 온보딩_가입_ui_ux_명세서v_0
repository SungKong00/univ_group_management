# 온보딩/가입 UI·UX 명세서 (Toss 철학 적용 · Flutter/Spring Boot) v0.9

> 본 문서는 프로젝트의 "회원가입/로그인" 전 구간을 토스 디자인 철학에 맞춰 구체화한 실행 명세입니다. 목표: 신규 유저가 **2분 내** 가입 완료. 교수 역할은 **승인 대기 배너**로 상태가 즉시 인지되도록 설계.

---

## 0. Design Principles (Toss 가이드 적용 요약)

- **한 화면 = 한 목표**: 단계별로 단일 행동만 남기기.
- **가치 먼저, 비용은 나중**: 필요한 정보 입력 전에, 가입으로 얻는 이점을 간단히 보여주기.
- **에러는 다음으로 안내**: 필드 수준 사전 방지 → 발생 시 원인+해결 동시 제시.
- **일관성 = 토큰/컴포넌트**: 같은 패턴, 같은 문구, 같은 타이밍.
- **친근하고 명확한 마이크로카피**: 해요체, 짧은 문장, 능동형.

---

## 1. 범위 & 목표 (Scope & KPIs)

- **범위**: **Google 인증 → (첫 로그인 시) 프로필 + 역할 선택 + 학교 이메일 인증(단일 화면 스크롤) → 가입 완료 → (교수) 승인 대기 안내**. 재방문/재로그인 사용자는 Google 인증 후 곧바로 홈으로 진입.
- **성공 지표**
  - 가입 전환율: [Google 로그인 시작] 대비 [가입 완료].
  - 평균 가입 소요 시간: Google 인증 완료 → 가입 완료.
  - 필드 에러율: 닉네임 중복/학교 이메일 인증 실패 비율.

---

## 2. 사용자 여정 (User Journey)

### 2.1 엔트리 포인트

- 앱 첫 실행 / 로그아웃 상태에서 **[시작하기]** → Google 로그인.
- 초대/공유 링크 유입 시: Google 로그인 후 컨텍스트 보존(가입 완료 시 해당 그룹 소개/모집 상세로 리디렉션).

### 2.2 단계 흐름 (Happy Path)

1. **Google 인증** (외부 OIDC)
2. **첫 로그인 전용 화면: 프로필 + 역할 선택 + 학교 인증** (단일 화면 스크롤)
   - 실명, 닉네임, 학과, 학번, 학교 이메일
   - [인증 코드 받기] → 동일 화면에서 코드 입력 필드/타이머(5:00) 등장 [개발 단계에서는 최후순위 구현으로 미루기]
   - \*\*역할 선택(학생/교수)\*\*은 이 화면 안에서 라디오/세그먼트로 선택
   - [가입 완료]
3. **완료 화면**
   - 학생: 홈으로 이동
   - 교수: 홈으로 이동 + 전역 상단 **승인 대기 배너**

### 2.3 재방문 흐름 (Returning User)

- Google 로그인 성공 → **바로 홈 진입**(프로필/역할 화면 스킵)

### 2.4 예외/우회 흐름 (Edge Paths)

- 닉네임 중복 → 인라인 에러 + 제안(랜덤 추천 닉네임)
- 인증 코드 불일치/만료 → 인라인 에러 + [재전송]
- 교수 인증 **반려** → 알림 + 권한 자동 학생 전환(사유 보기)

---

## 3. 화면 설계 (Screens)

### S-1. Google 인증 (외부)

- **목표**: 중단 최소화. 성공 시 앱으로 딥링크 복귀.
- **오류**: 인증 취소/실패 시 이전 화면으로, 토스트 "Google 인증을 완료해 주세요".

### S-2. 첫 로그인: 프로필 + 역할 + 학교 인증 (단일 화면)

- **목표**: 스크롤 한 화면으로 정보 입력을 끝내기.
- **필드 순서**: 실명 → 닉네임 → 학과 → 학번 → **역할 선택(학생/교수)** → 학교 이메일 → 인증 코드(동적 노출)
- **행동**
  - [인증 코드 받기]: 학교 이메일 형식/도메인 유효 시 활성화, 탭 시 코드 입력과 타이머(5:00) 나타남
  - [가입 완료]: 모든 필수 필드 유효 + 코드 검증 통과 시 활성화
- **보조요소**: 개인정보 처리/약관 요약 링크(모달)

### S-3. 가입 완료

- **학생**: 축하 일러스트(선택), "가입이 완료되었어요" → [홈으로]
- **교수**: "교수 권한 승인 대기 중이에요" → 상단 고정 배너 규칙 안내(닫을 수 없음)

### S-4. 승인 대기 배너(전역)

- **위치**: 앱 상단, 모든 주요 화면 노출
- **내용**: "교수 권한 승인 대기 중입니다. 승인되면 알려드릴게요."
- **상호작용**: [자세히] 탭 시 상태 설명 모달(예상 소요, 문의 경로)

---

## 4. 컴포넌트 & 상태 (UI Components & States)

### 입력 필드(Form Field)

- **실명**: 자동 대문자/공백 허용, 이모지 금지
- **닉네임**: 중복 체크(blur 시/지연 300ms), 2\~16자, 특수문자 제한
- **학과/학번**: 프리텍스트(초기 MVP)
- **역할 선택(세그먼트/라디오)**: 학생 / 교수 (기본값: 학생)
- **학교 이메일**: 도메인 화이트리스트(예: @hs.ac.kr), 형식 유효성
- **인증 코드**: 6자리 숫자, 입력 즉시 자동 포커스 이동(칸 분할형)

### 버튼(CTA)

- Primary(파란) / Secondary(회색 텍스트) / Destructive(빨강)
- 비활성 규칙: 필수 필드 유효+코드 검증 통과 전까지 비활성

### 타이머/칩

- 5:00 카운트다운, 0이 되면 코드 입력 비활성 + "만료됨" 레이블
- [재전송]은 30초 이후 활성

### 피드백

- **성공**: 상단 Toast "인증 코드를 보냈어요"
- **에러**: 필드 하단 인라인 + 토스트(네트워크/서버)
- **로딩**: 버튼 스피너(텍스트 → 스피너 아이콘)

### 빈 상태/오프라인

- 이메일 전송 실패 시: "전송이 지연되고 있어요. 잠시 후 다시 시도해 주세요"
- 오프라인: 화면 상단 작은 배너 "인터넷 연결이 필요해요"

## 5. 마이크로카피 가이드 (예시)

마이크로카피 가이드 (예시)

- **역할 선택**
  - 타이틀: "어떤 역할로 시작하시겠어요?"
  - 버튼: "학생으로 시작하기" / "교수·교직원으로 시작하기"
- **프로필**
  - 닉네임 placeholder: "앱에서 보여질 이름"
  - 이메일: "학교 이메일(@\_\_\_\_.edu)"
  - 인증 전송 성공: "인증 코드를 보냈어요"
  - 만료: "코드가 만료되었어요. 새 코드를 받아주세요"
  - 불일치: "코드가 일치하지 않아요"
- **완료**
  - 학생: "가입이 완료되었어요"
  - 교수: "교수 권한 승인 대기 중이에요"

---

## 6. 검증 규칙 & 예외 처리 (Validation & Edge Cases)

- **닉네임 중복**: blur 시 API로 중복 확인 → 중복이면 추천 리스트 노출(3개)
- **도메인 제한**: 화이트리스트 외 도메인 입력 시 즉시 에러
- **코드 만료/오입력**: 만료 배지/재전송 버튼, 연속 5회 실패 시 2분 쿨다운
- **교수 반려**: 알림 + 상태 모달(사유) → 권한 자동 학생으로, 배너 제거
- **가입 이탈**: 임시 저장 없음(MVP). 단, Google 인증 직후 10분 이내 복귀 시 이전 입력 복구(향후)

---

## 7. 접근성 & 반응형

- 터치 타깃 44dp 이상 / 라벨-필드 연결 / 에러 텍스트는 색+아이콘 동시 사용
- 키보드 다음 이동 순서 고정, 스크린리더 레이블 제공
- 모바일 기준(360\~430dp) → 태블릿/웹은 좌우 2열 레이아웃 적용

---

## 8. 디자인 토큰(초안)

- **컬러**: Primary(#0A84FF), Success, Warning, Danger, Surface, Text/Secondary
- **타이포**: H1 24/32, H2 20/28, Body 16/24, Caption 13/18
- **간격**: 4dp 그리드(8/12/16/20/24/32)
- **라운드**: 12/16
- **모션**: 전환 200–250ms, 토스트 2.5s, 타이머 칩 틱 1s

---

## 9. 이벤트 & 계측 (Analytics)

- oauth\_google\_start / oauth\_google\_success / oauth\_google\_fail
- **first\_login\_detected** (신규 사용자만)
- role\_choice\_made: student|professor (S-2에서 선택)
- profile\_submit\_click, email\_send\_click/success/fail
- otp\_verify\_success/fail/expired, signup\_complete
- professor\_pending\_banner\_view, professor\_rejected

---

## 10. API 연동 계약(초안)

- **POST /auth/google/callback** → { id\_token }
  - 서버: id\_token 검증 → **기존 유저면 세션 발급 후 /me** → 신규면 `firstLogin: true` 플래그와 함께 토큰 발급
- **POST /users** → { name, nickname, dept, studentNo, schoolEmail, **role** }
- **POST /email/verification/send** → { email }
- **POST /email/verification/verify** → { email, code }
- **POST /roles/apply** → { role } (role=PROFESSOR일 때 승인 대기 상태 생성)
- **GET /me** → { profile, role, professorStatus: PENDING|APPROVED|REJECTED }

> 에러코드 표준: `E_DUP_NICK`, `E_BAD_DOMAIN`, `E_OTP_MISMATCH`, `E_OTP_EXPIRED`

---

## 11. 플로우 다이어그램(텍스트)

- Start → **Google OAuth** → (firstLogin? yes → **프로필+역할+학교 인증**) → 가입 완료 → (교수) 승인 대기 배너 → 홈
- Start → **Google OAuth** → (firstLogin? no → **홈 진입**)

---

## 12. 테스트 시나리오(샘플)

1. **신규 학생**: Google 인증 → S-2 입력→ 이메일 인증 성공 → 2분 내 완료
2. **신규 교수**: Google 인증 → 역할=교수 선택 → 가입 완료 → 홈 상단 배너 노출 확인
3. **재방문 사용자**: Google 인증 후 프로필 화면 스킵, 홈 진입 확인
4. 닉네임 중복 1회 후 대체 닉네임 선택
5. 이메일 도메인 오류 → 수정 → 전송 성공
6. 코드 만료 → 재전송 → 성공

---

## 13. 구현 메모(Flutter)

- 화면: `RoleSelectPage` → `GoogleAuthHandler` → `ProfileAndSchoolVerifyPage` → `SignupDonePage`
- 위젯: `AppPrimaryButton`, `FormTextField`, `Otp6Input`, `TimerChip`, `TopBanner`
- 상태관리: Riverpod/Bloc 중 택1 (권장: Riverpod)

## 14. 구현 메모(Backend)

- Google OIDC 검증 → 신규면 유저 생성(임시) → 이메일 인증 성공 시 확정
- 교수 승인 workflow: 관리자 알림 발송, 승인/반려 이벤트 기록

---

### 부록 A. 마이크로카피 세트(초안)

- 전송 성공: "인증 코드를 보냈어요"
- 재전송 대기: "30초 후에 다시 보낼 수 있어요"
- 코드 만료: "코드가 만료되었어요. 새 코드를 받아주세요"
- 닉네임 중복: "이미 사용 중인 닉네임입니다"
- 교수 대기 배너: "교수 권한 승인 대기 중입니다. 승인되면 알려드릴게요"

### 부록 B. 에러/토스트 표준

- 토스트(정보): 2.5s, 상단
- 인라인 에러: 빨강 텍스트 + (!) 아이콘, 필드 하단
- 모달: 파괴적 행동 시에만 사용

---

## 15. 와이어프레임 (S-2 단일 화면 중심 · 모바일 우선)

> 대상: **첫 로그인 화면 – 프로필 + 역할 선택 + 학교 이메일 인증** 목표: 스크롤 1화면에서 **2분 내 가입**. "한 화면=한 목표"와 "가치 먼저"를 UX 카피와 배치로 구현.

### 15.1 레이아웃 스펙

- **뷰포트 기준**: 360–430dp(모바일), 세로 스크롤. 상·하 세이프에어리어 준수.
- **그리드**: 4dp 베이스 / 좌우 마진 20dp / 섹션 간격 24dp / 필드 간격 12–16dp.
- **섹션 구성(위→아래)**
  1. 헤더(선택): 서비스 로고(24dp 높이) · 건너뛰기 없음
  2. 타이틀/서브: H1 "가입을 마치면 이런 걸 할 수 있어요" + Bulleted value(최대 2줄)
  3. 프로필 필드: 실명, 닉네임(중복체크 포함)
  4. 학적 필드: 학과, 학번
  5. **역할 선택**: 세그먼트(학생 / 교수)
     - 안내 서브텍스트(역할=교수 선택 시): "교수 권한은 승인 후 활성화돼요"
  6. 학교 이메일 + [인증 코드 받기]
  7. OTP 영역(전송 후 노출): 6칸 입력 + 타이머칩(5:00) + [재전송]
  8. **주요 CTA**: [가입 완료]
  9. 푸터: 약관/개인정보 링크(모달)

### 15.2 컴포넌트 배치(텍스트 와이어)

```
[LOGO]

가입을 마치면 이런 걸 할 수 있어요
• 관심 그룹을 찾고 바로 지원
• 공지/채널에서 빠르게 소통

[실명]  ______________________
[닉네임]  ________________  (중복 확인 아이콘)
  └ 에러/도움말 영역

[학과]   ______________________
[학번]   ______________________

[역할 선택]  ( ● 학생   ○ 교수 )
  └ (교수 선택 시) 안내텍스트: 승인 대기 안내

[학교 이메일]  ________________@____.edu   [인증 코드 받기]
  └ 에러/도움말 영역

(전송 후)
[ 1 ][ 2 ][ 3 ][ 4 ][ 5 ][ 6 ]   [04:58]
[재전송]
  └ 에러/도움말 영역(만료/불일치)

[ 가입 완료 ]  (Primary)

약관 · 개인정보 처리방침
```

### 15.3 상태 정의(주요 케이스)

- **초기**: OTP 영역 숨김, [가입 완료] 비활성, [인증 코드 받기] 비활성(도메인·형식 유효 시 활성)
- **닉네임 중복**: 인라인 에러 + 대체안 칩 3개(탭 시 자동 채움)
- **이메일 전송 성공**: 상단 토스트 "인증 코드를 보냈어요" + OTP 영역 슬라이드 인(200ms)
- **OTP 입력 중**: 각 칸 자동 포커스 이동, 전체 6자리 입력 시 자동 검증(로딩 스피너 600–800ms)
- **OTP 불일치**: 인라인 에러 "코드가 일치하지 않아요" + 흔들림 미세 모션(80ms, 2회)
- **OTP 만료**: 타이머 00:00 → 칩에 "만료됨" 표시, 입력 비활성, [재전송] 활성
- **오프라인**: 상단 배너 "인터넷 연결이 필요해요" 고정, 전송/검증 버튼 비활성
- **역할=교수 선택**: 역할 행 아래 서브텍스트 노출(아이콘 ℹ︎): "교수 권한은 승인 후 활성화돼요"

### 15.4 상호작용 & 모션

- **전환**: OTP 영역 등장/퇴장 슬라이드(위→아래 200–250ms, 투명도 0→1)
- **피드백**: 토스트 2.5s(상단), 버튼 탭 시 잉크리플/해피스틱(가벼운 햅틱)
- **에러**: 필드 흔들림(±4dp, 80ms×2), 에러 아이콘 페이드인

### 15.5 입력 제약/마스크

- 실명: 이모지/특수문자 차단, 공백 1칸 정규화
- 닉네임: 2–16자, 영문/숫자/한글 허용, 연속 공백 금지
- 학번: 숫자만, 자리수 6–10 (학교별 유연성), 자동 그룹화 없음
- 이메일: 도메인 화이트리스트(@hs.ac.kr). 형식 미일치 시 [인증 코드 받기] 비활성
- OTP: 숫자 6자리, 붙여넣기 시 자동 분할

### 15.6 버튼 활성 규칙

- [인증 코드 받기]: email 유효·도메인 허용 → 활성
- [가입 완료]: 필수 필드 유효 + OTP 검증 통과 → 활성

### 15.7 마이크로카피(권장 문안)

- 타이틀: "가입을 마치면 이런 걸 할 수 있어요"
- 가치 포인트: "관심 그룹을 찾고 바로 지원", "공지와 채널에서 빠르게 소통"
- 이메일 도움말: "학교 이메일(@\_\_\_\_.edu)로 인증해요"
- 전송 성공: "인증 코드를 보냈어요"
- 만료: "코드가 만료되었어요. 새 코드를 받아주세요"
- 불일치: "코드가 일치하지 않아요"
- 역할 안내(교수): "교수 권한은 승인 후 활성화돼요"

### 15.8 접근성/반응형 가이드

- 터치 타깃 44dp / 라벨과 필드 연결 / 에러는 색+아이콘 동시 사용
- 키보드 다음 이동 순서 고정(Tab/다음), Return 시 다음 필드 포커스
- 태블릿/웹(≥768dp)에서는 좌/우 2열: 좌(프로필/학적/역할), 우(이메일/OTP/CTA)

### 15.9 웹 환경 차이

- 브라우저 자동완성(이름/이메일) 허용, OTP 입력은 `one-time-code` 힌트 속성
- 새 탭 OAuth 복귀 시 상태 유지(폼 값 보존)

### 15.10 Flutter 위젯 트리(예시)

```
Scaffold
 └ SafeArea
    └ SingleChildScrollView
       └ Column(spacing:24)
          ├ ValueHeader()
          ├ ProfileSection(nameField, nicknameField)
          ├ AcademicSection(deptField, studentNoField)
          ├ RoleSegmentedControl(value: student|professor)
          ├ EmailSection(emailField, sendCodeButton)
          ├ OtpSection(visibleAfterSend: true, otp6, timerChip, resend)
          ├ PrimaryButton("가입 완료")
          └ FooterLinks(약관/개인정보)
```

### 15.11 수용 기준(AC)

1. 이메일 전송 후 1초 내 OTP 영역이 슬라이드 인한다.
2. 6자리 입력 완료 즉시 자동 검증을 시작하고, 성공 시 300ms 내 [가입 완료] 활성화.
3. OTP 만료 시 입력이 비활성화되고, [재전송]이 즉시 활성화된다(전송 간 최소 30초 간격).
4. 역할=교수 선택 시 안내 텍스트가 항상 노출된다.
5. 오프라인 상태에서는 전송/검증/완료 버튼이 모두 비활성화되고, 상단 배너가 노출된다.
