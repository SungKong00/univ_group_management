# 6. 알림 시스템

### 1. 기술 아키텍처 (확장성을 위한 설계)

- **구조화된 데이터 저장**: 향후 '개인화 홈' 기능의 원활한 개발을 위해, 알림 데이터는 발생 주체, 대상, 종류 등 모든 정보를 포함하는 **구조화된 데이터**로 저장합니다.
- **데이터 보관 정책**: 서비스 안정성과 데이터베이스 최적화를 위해, 생성된 지 **90일이 지난 알림 데이터는 자동으로 삭제**하는 기간제 보관 정책을 채택합니다.

### 2. 사용자 경험 (UX/UI)

- **알림 아이콘 및 상태 표시**:
    - 서비스 상단 헤더에 **종(🔔) 모양 아이콘**을 배치합니다.
    - 읽지 않은 새 알림이 있을 경우, 아이콘 위에 **빨간 점(Badge)**을 표시합니다.
- **알림 목록**:
    - 종 아이콘 클릭 시, 최신순으로 정렬된 알림 목록이 **드롭다운(Dropdown)** 형태로 나타납니다.
    - 각 알림은 **[프로필 사진] + [알림 내용] + [시간]**으로 구성됩니다.
- **읽음 처리**:
    - 사용자가 알림 드롭다운 목록을 열어보는 순간, **화면에 표시된 알림들**은 자동으로 **'읽음' 상태로 처리**되고, 빨간 점은 사라집니다.
- **클릭 시 이동**:
    - 사용자가 특정 알림을 클릭하면, 해당 활동이 발생한 페이지(예: 댓글이 달린 게시물)로 **즉시 이동**합니다.

### 3. MVP에 포함될 알림 종류 (Triggers)

MVP에서는 사용자와 직접적인 상호작용이 발생했을 때만 알림을 전송합니다.

- **그룹 및 멤버 관련**:
    - 내 그룹 가입 신청이 **승인 또는 거절**되었을 때
    - 내가 그룹장인 그룹에 **새로운 가입 신청**이 들어왔을 때
    - 나의 **역할이 변경**되었을 때

### 4. API 명세 (UI/UX 명세서 v1.0 기준)

| 기능 | HTTP Method | URI | Request Body | Response Body | 설명 |
| --- | --- | --- | --- | --- | --- |
| 알림 목록 조회 | GET | /notifications?limit={limit}&cursor={cursor} | | `PagedResult<NotificationDto>` | 커서 기반 페이지네이션으로 알림 목록을 최신순으로 조회합니다. |
| **알림 일괄 읽음 처리** | **PATCH** | **/notifications/read** | `ReadNotificationsRequest` | (204 No Content) | **ID 목록을 받아** 해당 알림들만 '읽음' 상태로 변경합니다. |

*참고: 개별 알림 삭제 API는 90일 자동 삭제 정책에 따라 MVP 범위에서 제외합니다.*

### 5. DTO (Data Transfer Object) 정의

- **PagedResult<T>**
    - `data: List<T>`
    - `nextCursor: String`
- **NotificationDto**
    - `notificationId: Long`
    - `type: String` (e.g., "JOIN_APPROVED", "NEW_JOIN_REQUEST", "ROLE_CHANGED")
    - `title: String`
    - `body: String`
    - `actor: { userId, nickname, profileImageUrl }`
    - `isRead: Boolean`
    - `createdAt: DateTime`
    - `deeplink: String` (클릭 시 이동할 프론트엔드 경로)
- **ReadNotificationsRequest**
    - `ids: List<Long>`
