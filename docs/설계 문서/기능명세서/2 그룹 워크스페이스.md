### **그룹/워크스페이스 기능 명세서 (v2.1 - 통합본)**

> **🔴 구현 상태:** 백엔드 API 완전 구현 완료
> **📅 최종 업데이트:** 2025-09-19

**1. 기능 개요**

- 본 기능은 사용자들이 공통의 목표를 가진 커뮤니티(그룹)를 형성하고, 해당 그룹 전용의 협업 공간(워크스페이스)을 생성 및 운영할 수 있도록 지원합니다.
- 모든 그룹은 '한신대학교'라는 최상위 계층 아래에 생성되며, 명확한 관리 체계와 승인 절차를 통해 체계적인 그룹 관리를 목표로 합니다.
- **용어 정의**: 모든 그룹은 반드시 하나의 워크스페이스를 가지는 **1:1 구조**입니다.

**2. 사용자 역할 및 권한**

| 역할 | 설명 | 주요 권한 |
| --- | --- | --- |
| **시스템 관리자** | 서비스 전체를 관리하는 최고 권한자 | • 대학 조직도에 따른 핵심 그룹 생성<br>• 그룹장 유고 시 개입 및 권한 처리 |
| **그룹장** | 개별 그룹의 운영을 총괄하는 대표 | • 하위 그룹 신청 승인/반려<br>• 멤버 가입 신청 승인/반려<br>• 지도교수 지정/해제<br>• 그룹장 권한 위임<br>• 그룹 삭제 |
| **지도교수** | 그룹장이 지정한 담당 교직원 | • 그룹 관리 권한 일부 공유 (역할 설정에 따름) |
| **그룹 멤버** | 그룹에 소속된 일반 사용자 | • 콘텐츠 열람 및 생성<br>• 그룹 탈퇴 |
| **일반 사용자** | 그룹에 소속되지 않은 사용자 | • 그룹 검색 및 정보 조회<br>• 그룹 가입 신청 |

**3. 주요 기능 명세**

**3.1. 그룹 생성 방식**

- **3.1.1. 독립 그룹 생성**: 사용자가 `POST /api/groups` API를 통해 그룹명, 설명 등 기본 정보를 제출하면 **별도의 승인 절차 없이** 즉시 그룹이 생성됩니다.
- **3.1.2. 하위 그룹 생성 신청**: 특정 그룹 아래에 소속될 하위 그룹을 만들고 싶을 경우, `POST /api/groups/{groupId}/sub-groups/requests` API를 통해 **상위 그룹 관리자의 승인**을 요청합니다.

**3.2. 승인 워크플로우**

- **하위 그룹/멤버 가입 신청 관리**: 그룹 관리자는 `.../requests` 경로의 `GET` API로 신청 목록을 조회하고, `PATCH` API로 각 신청을 승인/반려합니다.

**3.3. 그룹장 기능**

- **권한 위임**: `POST /api/groups/{groupId}/transfer-ownership/{newOwnerId}` API를 통해 다른 멤버에게 그룹장 권한을 위임합니다.
- **멤버 추방**: `DELETE /api/groups/{groupId}/members/{userId}` API를 통해 멤버를 그룹에서 추방합니다.
- **그룹 삭제**: `DELETE /api/groups/{groupId}` API를 통해 그룹을 삭제(소프트 삭제)합니다.

**4. 주요 정책 및 규칙**

- **4.1. 데이터 삭제 정책 (소프트 삭제)**: 그룹 삭제 시, 데이터는 영구 삭제되지 않고 '삭제됨' 상태로 변경(Soft Delete)됩니다.
- **4.2. 그룹 이름 중복 정책**: 동일한 상위 그룹 내에서는 같은 이름의 하위 그룹을 생성할 수 없습니다 (**형제 내 고유**). 단, 다른 그룹 아래에는 동일한 이름의 그룹 생성이 가능합니다.
- **4.3. 그룹 공개 정책**: 모든 그룹은 **공개**를 기본 정책으로 하며, 별도의 공개/비공개 설정 기능은 MVP 범위에 포함하지 않습니다.
- **4.4. 예외 처리 (그룹장 유고)**: 그룹장이 장기 미접속, 계정 삭제 등으로 부재 시, 다른 멤버의 요청 또는 관리자 판단 하에 **시스템 관리자가 직접 개입**하여 새로운 그룹장을 지정합니다.

**5. API 명세 (v2.1 - 코드 기준)**

| 기능 | HTTP Method | URI | 설명 |
| --- | --- | --- | --- |
| 독립 그룹 생성 | `POST` | `/api/groups` | 승인 없이 즉시 생성되는 그룹. |
| 그룹 탐색/검색 | `GET` | `/api/groups/explore?query=...` | 검색어, 태그 등으로 그룹을 필터링하여 조회. |
| 그룹 상세 조회 | `GET` | `/api/groups/{groupId}` | 특정 그룹의 상세 정보를 조회. |
| 워크스페이스 조회 | `GET` | `/api/groups/{groupId}/workspace` | 회원이 속한 그룹의 워크스페이스 정보를 조회. |
| 그룹 가입 신청 | `POST` | `/api/groups/{groupId}/join` | 특정 그룹에 가입을 신청. |
| 가입 신청 목록 조회 | `GET` | `/api/groups/{groupId}/join-requests` | 해당 그룹에 온 가입 신청 목록을 조회. |
| 가입 신청 처리 | `PATCH` | `/api/groups/{groupId}/join-requests/{requestId}` | 가입 신청을 승인 또는 반려. |
| 멤버 목록 조회 | `GET` | `/api/groups/{groupId}/members` | 그룹의 현재 멤버 목록을 조회. |
| 하위 그룹 생성 신청 | `POST` | `/api/groups/{groupId}/sub-groups/requests` | 특정 그룹 산하에 하위 그룹 생성을 신청. |
| 하위 그룹 신청 목록 | `GET` | `/api/groups/{groupId}/sub-groups/requests` | 하위 그룹 생성 신청 목록을 조회. |
| 하위 그룹 신청 처리 | `PATCH` | `/api/groups/{groupId}/sub-groups/requests/{requestId}` | 하위 그룹 신청을 승인 또는 반려. |

**6. 추가 구현 사항 및 정책**

- **워크스페이스 자동 생성**: 그룹 생성 시, 해당 그룹에 대한 워크스페이스와 기본 채널(공지, 자유)이 자동으로 함께 생성됩니다.
- **개인 권한 오버라이드 시스템**: ❌ **미구현**. 역할 기반 권한 외에 개인별로 권한을 추가 허용/차단하는 기능은 현재 코드에 구현되어 있지 않습니다.

**7. DTO (Data Transfer Object) 정의 (주요 항목)**

- **CreateGroupRequest**: `{ name, description, isPublic, university, department, maxMembers }`
- **SubGroupRequest**: `{ requestedGroupName, requestedGroupDescription, ... }`
- **JoinRequestAction**: `{ action: "APPROVE" | "REJECT" }`
- **MemberDto**: `{ userId, nickname, profileImageUrl, role, joinedAt }`

**8. 용어 정의**

- **그룹 (Group):** 사용자의 커뮤니티 단위. 멤버십과 관리 권한을 가집니다.
- **워크스페이스 (Workspace):** 그룹에 1:1로 종속되는 데이터 및 협업 공간. 게시물, 파일 등의 콘텐츠를 포함합니다.