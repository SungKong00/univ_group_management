# 멤버 필터링 시스템 (Member Filtering System)

그룹 내 멤버를 효율적으로 조회, 필터링, 관리하기 위한 시스템입니다.

## 개요

**목적**: 다양한 상황에서 특정 조건의 멤버를 빠르게 찾고 선택

대학 그룹 관리 시스템은 학과, 동아리, 학회 등 다양한 조직을 지원하며, 각 조직마다 수십~수백 명의 멤버를 관리합니다. 효율적인 멤버 관리를 위해서는 역할, 학년, 학번, 소속 그룹 등 다양한 기준으로 멤버를 필터링할 수 있어야 합니다.

## 필터 종류

### 역할 필터 (특수 - 단독 동작)
**현재 그룹에서의 역할**로 필터링합니다.

- 그룹장, 교수, 멤버, 커스텀 역할
- **특수 동작**: 역할 선택 시 다른 모든 필터 비활성화
- 항목 내 OR: 그룹장 OR 교수 OR 멤버
- 사용 예: "운영진만 조회", "일반 멤버만 조회"

### 소속 그룹 필터
**현재 그룹의 하위 그룹** 멤버십으로 필터링합니다.

- 현재 그룹의 직계 하위 그룹 목록 표시
- 항목 내 OR: AI 학회 OR 프로그래밍 동아리
- 사용 예: "프로그래밍 동아리 소속 멤버", "여러 동아리 소속 멤버"
- **의미**: "현재 그룹의 멤버 중에서 선택한 하위 그룹에도 동시에 소속된 멤버"

### 학년 필터
**학년**으로 필터링합니다.

- 1학년, 2학년, 3학년, 4학년, 졸업생, 기타
- 항목 내 OR: 2학년 OR 3학년
- **특수**: 학번 필터와 OR 관계 (예외)

### 학번 필터 (입학년도)
**입학년도**로 필터링합니다.

- 입력 "2024" → 표시 "24학번"
- DB에 존재하는 학번만 동적 생성
- 항목 내 OR: 24학번 OR 25학번
- **특수**: 학년 필터와 OR 관계 (예외)

## 필터 조합 로직

### 역할 필터 (단독)
```
역할: 그룹장, 교수 선택
→ 그룹장 OR 교수
→ 다른 필터 모두 비활성화
```

### 일반 필터 (복합)
**기본 원칙**: 항목 간 AND, 항목 내 OR

```
소속 그룹: AI 학회, 프로그래밍 동아리
학년: 2학년, 3학년
학번: 24학번

결과:
(AI 학회 OR 프로그래밍 동아리)
AND
((2학년 OR 3학년) OR 24학번)

→ "AI 학회 또는 프로그래밍 동아리에 소속되어 있으면서
    2학년 또는 3학년 또는 24학번인 멤버"
```

**예외**: 학년과 학번은 OR 관계 (동일 범주로 취급)

## 주요 사용 시나리오

### 1. 멤버 관리 페이지
- 역할별 조회 (역할 일괄 변경)
- 학년별 조회 (학년별 통계)
- 소속 그룹별 조회 (하위 그룹 활동 파악)

### 2. 일정 참여자 선택 (Phase 8+)
- "운영진만 초대" (역할 필터)
- "1학년 오리엔테이션" (학년 필터)
- "AI 학회 소속 2학년" (복합 필터)

### 3. 통계/분석 화면
- 역할별 분포
- 학년별 분포
- 하위 그룹 참여 현황

## 필터링 전략

### 서버 사이드 필터링 (권장)
**방식**: API 쿼리 파라미터로 필터 전달

```
GET /api/groups/{groupId}/members?roleIds=1,2&groupIds=10,20&grades=2,3&years=24,25
```

**장점**:
- DB 인덱스 활용 (성능 최적화)
- 대량 데이터 처리 가능
- 네트워크 전송량 최소화

### 데이터베이스 최적화
**인덱스**:
- `users.academic_year`: 학년 필터링
- `group_members.(group_id, role_id)`: 역할 필터링
- `group_members.(user_id, group_id)`: 소속 그룹 조인

**쿼리 최적화**:
- Fetch Join으로 N+1 문제 방지
- 페이지네이션 (기본 20명/페이지)

## 향후 확장 가능성

### Phase 9+ (캘린더 연동)
- 시간표 겹침 여부 (일정 시간과 비교)
- 일정 참여 이력 (이전 행사 참여/불참)

### Phase 10+ (고급 기능)
- 저장된 필터 프리셋 ("운영진 회의", "신입생 행사")
- 커스텀 태그 시스템 ("프론트엔드", "백엔드")

## 관련 문서

- [멤버 필터 UI 설계](../ui-ux/components/member-list-component.md) - UI/UX 컴포넌트
- [멤버 필터 구현](../implementation/frontend/member-list-implementation.md) - 프론트엔드 구현
- [권한 시스템](permission-system.md) - 멤버 역할 및 권한
- [그룹 계층](group-hierarchy.md) - 그룹 구조 및 멤버십
