# 캘린더 시스템 (Calendar System)

본 문서는 프로젝트의 캘린더 기능에 대한 개념적 개요를 설명합니다. 캘린더 시스템은 크게 **학교 시간표**, **개인 일정 캘린더**, **그룹 캘린더**, **장소 캘린더** 네 가지로 구성됩니다.

## 1. 학교 시간표 (School Timetable)

사용자가 자신의 대학 강의 시간표 및 고정적인 개인 일정을 관리하고 시각적으로 확인하는 기능입니다.

### 주요 특징

-   **뷰**: 기본적으로 월요일부터 토요일, 오전 9시부터 오후 7시까지의 시간표를 보여줍니다. 만약 오후 7시를 넘어가는 일정이 있다면, 뷰가 자동으로 확장되어 해당 일정을 모두 표시합니다.
-   **일정 추가 방식**:
    1.  **강의 추가**: 관리자가 사전에 등록한 학교의 공식 강의 목록에서 자신이 수강하는 과목을 선택하여 시간표에 자동으로 추가합니다.
    2.  **사용자 지정 반복 일정 추가**: 매주 반복되는 개인 일정(예: 아르바이트, 근로 장학생, 동아리 정기 회의)을 직접 생성하여 시간표에 추가할 수 있습니다.

## 2. 개인 일정 캘린더 (Personal Calendar)

사용자 개인의 모든 일정을 통합하여 보여주는 중앙 허브 역할을 합니다. 개발 우선순위는 다른 캘린더 기능 구현 후로 합니다.
자신이 속해있는 그룹에서 일정에 참가하게 된다면, 이 개인 일정 캘린더에서 조회할 수 있습니다.

### 주요 특징

-   **통합 뷰**: 다음 일정들을 모두 모아서 보여줍니다.
    -   자신의 학교 시간표
    -   자신이 참여자로 지정된 모든 그룹의 공식 일정
    -   자신이 참여 신청한 모든 그룹의 공식 일정
    -   자신이 직접 생성한 비공식 그룹 일정
-   **목적**: 개인은 이 캘린더를 통해 자신의 모든 일정을 한 곳에서 종합적으로 파악할 수 있습니다.

## 3. 그룹 캘린더 (Group Calendar)

각 워크스페이스에 종속되어, 해당 워크스페이스의 멤버들이 공유하는 캘린더입니다.

### 3.1. 일정의 종류

그룹 캘린더의 일정은 **공식 일정**과 **비공식 일정**으로 나뉩니다.

-   **공식 일정 (Official Event)**
    -   **생성 권한**: `CALENDAR_MANAGE` 권한을 가진 멤버(예: 그룹장, 운영진)만 생성할 수 있습니다.
    -   **특징**: 그룹의 공식적인 활동을 나타내며, 다양한 부가 기능을 가집니다.
-   **비공식 일정 (Unofficial Event)**
    -   **생성 권한**: 그룹에 속한 모든 멤버가 자유롭게 생성할 수 있습니다.
    -   **특징**: 멤버들 간의 비공식적인 약속이나 소규모 모임 등을 위해 사용됩니다.

### 3.2. 공식 일정의 세부 기능

공식 일정은 목적에 따라 세 가지 방식으로 생성할 수 있습니다.

#### 1. 대상 미지정 (General Event)

-   **목적**: 특정 대상 없이 그룹 전체에 공지하는 단순 일정입니다. (예: '프로젝트 중간 발표일')
-   **기능**: 캘린더에 일정만 기록되며 별도의 알림이나 참여 기능은 없습니다.

#### 2. 대상자 지정 (Targeted Event)

-   **목적**: 특정 조건을 만족하는 멤버들을 대상으로 하는 일정입니다. (예: '1학년 신입생 환영회')
-   **대상자 선택**: 일정을 생성할 때 **학년, 역할, 학번** 등의 조건으로 대상자 그룹을 지정할 수 있습니다.
-   **자동화 기능**:
    -   **알림**: 대상자로 지정된 모든 멤버에게 새로운 일정이 추가되었다는 알림이 발송됩니다.
    -   **캘린더 추가**: 해당 일정이 대상자들의 개인 캘린더에 자동으로 추가됩니다.
-   **참여 의사 표시**:
    -   대상자는 일정에 대해 **불참(Decline)** 의사를 표시할 수 있습니다.
    -   불참 시 간단한 사유를 선택하거나 직접 입력할 수 있습니다.

#### 3. 참여자 신청 (RSVP Event)

-   **목적**: 참여를 원하는 멤버들의 신청을 받는 공개 이벤트입니다. (예: '선배와의 대화 신청')
-   **기능**:
    -   일정이 생성되면 멤버들은 **참여 신청(Apply)** 버튼을 누를 수 있습니다.
    -   현재까지 몇 명이 참여 신청했는지 실시간으로 확인할 수 있습니다.
    -   참여 신청을 한 멤버의 개인 캘린더에 해당 일정이 자동으로 추가됩니다.

### 3.3. 편의 기능

#### 최적 시간 추천 (Smart Time Recommendation)

-   **목적**: '대상자 지정' 일정 생성 시, 참여 가능한 인원이 가장 많은 시간을 추천해주는 기능입니다.
-   **동작 방식**:
    1.  일정 생성자가 대상자 그룹을 지정합니다.
    2.  시스템은 대상자 및 장소의 시간표 데이터를 종합하여 분석합니다.
    3.  생성자는 토글을 통해 분석에 포함할 데이터 소스를 선택할 수 있습니다.
        -   **학교 시간표 (선택)**
        -   **개인 일정 (선택)**
        -   **장소 예약 현황 (선택, 장소 지정 시)**
    4.  분석 결과를 바탕으로, 시간대별로 '가능 인원'과 '불가능 인원' 수를 시각적으로 보여주어 최적의 일정 수립을 돕습니다.

#### 채널 게시글 연동 (Channel Post Integration)

-   **목적**: 캘린더 일정을 채널 게시글과 연동하여 멤버들의 접근성과 참여율을 높입니다.
-   **기능**:
    -   일정 생성 마지막 단계에서, 생성자는 자신이 작성 권한을 가진 채널을 선택하여 관련 게시글을 바로 작성할 수 있습니다.
    -   게시글은 다음과 같은 구조로 자동 생성됩니다.
        -   **상단**: 일정 제목, 시간, 장소 등 핵심 정보 요약
        -   **중간**: 생성자가 입력한 상세 내용
        -   **하단**: 일정 종류에 따른 액션 버튼 (예: `[불참 의사 밝히기]`, `[참여 신청하기]`)
    -   이 기능을 사용하지 않으면, 멤버들은 캘린더에 직접 들어가야만 일정에 대한 상호작용(불참, 신청 등)을 할 수 있습니다.

## 4. 장소 캘린더 (Place Calendar)

장소 캘린더는 학생 자치 활동으로 관리되는 특정 장소(예: 동아리방, 랩실, 회의실)의 예약 및 일정 관리를 위한 기능입니다. 장소를 사용하는 그룹 중 최상위 그룹이 관리 주체가 되어 장소의 예약 가능 시간을 설정하고, 예약을 관리합니다.

### 4.1. 장소의 정의 및 관리 주체
- **식별**: 장소는 `건물-방 번호`로 고유하게 식별됩니다. 예: `60주년 기념관-18203`
- **표시**: 사용자에게는 `건물-방 번호(별칭)` 형태로 표시됩니다. 예: `60주년 기념관-18203(AISC랩실)`
- **관리 주체**: 해당 장소를 사용하는 그룹 중 최상위 그룹이 관리 권한을 가집니다.
- **기본 데이터**: `건물` 정보는 시스템 관리자(admin)가 사전에 등록하여 제공합니다.

### 4.2. 장소 등록 프로세스
1.  워크스페이스 설정에서 '그룹 장소 추가' 버튼을 클릭합니다.
2.  시스템에 등록된 `건물` 목록에서 건물을 선택합니다.
3.  해당 건물에 등록된 `방 번호`가 없는 경우, 새로 방 번호를 입력하여 생성합니다.
4.  장소의 `별칭`(예: AISC랩실)을 입력합니다.
5.  등록이 완료되면, 해당 그룹은 장소의 관리 주체가 됩니다.
    - 만약 다른 그룹이 이미 선점한 장소일 경우, 등록이 불가능하며, 해당 장소를 누가 관리하는지 안내합니다.

### 4.3. 장소 관리자 기능
장소의 관리 주체인 그룹의 관리자는 다음 권한을 가집니다.

- **예약 현황 조회**: 장소 캘린더를 통해 시간대별 예약 그룹, 예약자, 예약 시간을 확인할 수 있습니다.
- **강제 예약 취소**: 특정 예약을 강제로 취소할 수 있습니다. 취소 시, 해당 예약을 생성했던 사용자에게 알림 또는 메시지가 전송됩니다.
- **예약 가능 시간 설정**:
    - **반복 설정**: 주 단위로 요일과 시간을 지정하여 예약 가능한 시간을 일괄적으로 설정할 수 있습니다. (예: 매주 월~금, 오전 9시부터 오후 7시까지)
    - **개별 차단**: 특정 날짜나 시간대를 개별적으로 예약 불가능하도록 막을 수 있습니다.

### 4.4. 사용자 기능
- **장소 예약**:
    - 장소를 관리하는 그룹 또는 그 하위 그룹의 멤버는 일정을 생성할 때, 관리되고 있는 장소를 선택하여 예약할 수 있습니다.
    - 예약이 완료되면 장소 캘린더에 `예약 그룹`, `예약자`, `예약 시간`이 자동으로 기록됩니다.

### 4.5. UI/UX 및 접근성
- **네비게이션 메뉴**: 장소를 관리하는 그룹 및 그 하위 그룹의 워크스페이스 네비게이션 바에 '장소 캘린더' 메뉴가 표시됩니다.
- **캘린더 선택**: 만약 소속된 상위 그룹이 여러 개의 장소를 관리하는 경우, 사용자는 드롭다운 등의 UI를 통해 원하는 장소의 캘린더를 선택하여 조회할 수 있습니다.

### 4.6. 향후 구현 기능 (후순위)
- **관리자와의 다이렉트 메시지(DM)**: 사용자가 이미 예약된 시간대에 예약을 시도하거나, 장소 등록 시 이미 선점된 장소일 경우, 현재 관리자와 소통하여 조율할 수 있도록 DM 보내기 기능을 추가합니다.