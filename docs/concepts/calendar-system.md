# 캘린더 시스템 (Calendar System)

본 문서는 프로젝트의 캘린더 기능에 대한 개념적 개요를 설명합니다. 캘린더 시스템은 크게 **학교 시간표**, **개인 일정 캘린더**, **그룹 캘린더**, **장소 캘린더** 네 가지로 구성됩니다.

학교 시간표, 개인 일정 캘린더는 사이드 바의 캘린더에서 확인이 가능하며, 그룹캘린더, 장소 캘린더는 워크스페이스의 그룹 캘린더에서 확인 가능하다.
그룹 캘린더에서는 개인, 학교 시간표를 상단에서 체크를 해 겹쳐서 보거나 끌 수 있다.

## 1. 학교 시간표 (School Timetable)

사용자가 자신의 대학 강의 시간표 및 고정적인 개인 일정을 관리하고 시각적으로 확인하는 기능입니다.

### 주요 특징

-   **뷰**: 기본적으로 월요일부터 토요일, 오전 9시부터 오후 7시까지의 시간표를 보여줍니다. 만약 오후 7시를 넘어가는 일정이 있다면, 뷰가 자동으로 확장되어 해당 일정을 모두 표시합니다.
-   **일정 추가 방식**:
    1.  **강의 추가**: 관리자가 사전에 등록한 학교의 공식 강의 목록에서 자신이 수강하는 과목을 선택하여 시간표에 자동으로 추가합니다.
    2.  **사용자 지정 반복 일정 추가**: 매주 반복되는 개인 일정(예: 아르바이트, 근로 장학생, 동아리 정기 회의)을 직접 생성하여 시간표에 추가할 수 있습니다.

## 2. 개인 일정 캘린더 (Personal Calendar)

사용자 개인의 모든 일정을 통합하여 보여주는 중앙 허브 역할을 합니다. 개발 우선순위는 다른 캘린더 기능 구현 후로 합니다.
자신이 속해있는 그룹에서 일정에 참가하게 된다면, 이 개인 일정 캘린더에서 조회할 수 있습니다.

### 주요 특징

-   **통합 뷰**: 다음 일정들을 모두 모아서 보여줍니다.
    -   자신의 학교 시간표
    -   자신이 참여자로 지정된 모든 그룹의 공식 일정
    -   자신이 참여 신청한 모든 그룹의 공식 일정
    -   자신이 직접 생성한 비공식 그룹 일정
-   **목적**: 개인은 이 캘린더를 통해 자신의 모든 일정을 한 곳에서 종합적으로 파악할 수 있습니다.

## 3. 그룹 캘린더 (Group Calendar)

각 워크스페이스에 종속되어, 해당 워크스페이스의 멤버들이 공유하는 캘린더입니다.

### 3.1. 일정의 종류

그룹 캘린더의 일정은 **공식 일정**과 **비공식 일정**으로 나뉩니다.

-   **공식 일정 (Official Event)**
    -   **생성 권한**: `CALENDAR_MANAGE` 권한을 가진 멤버(예: 그룹장, 운영진)만 생성할 수 있습니다.
    -   **특징**: 그룹의 공식적인 활동을 나타내며, 다양한 부가 기능을 가집니다.
-   **비공식 일정 (Unofficial Event)**
    -   **생성 권한**: 그룹에 속한 모든 멤버가 자유롭게 생성할 수 있습니다.
    -   **특징**: 멤버들 간의 비공식적인 약속이나 소규모 모임 등을 위해 사용됩니다.

### 3.2. 공식 일정의 세부 기능

공식 일정은 목적에 따라 세 가지 방식으로 생성할 수 있습니다.

#### 1. 대상 미지정 (General Event)

-   **목적**: 특정 대상 없이 그룹 전체에 공지하는 단순 일정입니다. (예: '프로젝트 중간 발표일')
-   **기능**: 캘린더에 일정만 기록되며 별도의 알림이나 참여 기능은 없습니다.

#### 2. 대상자 지정 (Targeted Event)

-   **목적**: 특정 조건을 만족하는 멤버들을 대상으로 하는 일정입니다. (예: '1학년 신입생 환영회')
-   **대상자 선택**: 일정을 생성할 때 **학년, 역할, 학번** 등의 조건으로 대상자 그룹을 지정할 수 있습니다.
-   **자동화 기능**:
    -   **알림**: 대상자로 지정된 모든 멤버에게 새로운 일정이 추가되었다는 알림이 발송됩니다.
    -   **캘린더 추가**: 해당 일정이 대상자들의 개인 캘린더에 자동으로 추가됩니다.
-   **참여 의사 표시**:
    -   대상자는 일정에 대해 **불참(Decline)** 의사를 표시할 수 있습니다.
    -   불참 시 간단한 사유를 선택하거나 직접 입력할 수 있습니다.

#### 3. 참여자 신청 (RSVP Event)

-   **목적**: 참여를 원하는 멤버들의 신청을 받는 공개 이벤트입니다. (예: '선배와의 대화 신청')
-   **기능**:
    -   일정이 생성되면 멤버들은 **참여 신청(Apply)** 버튼을 누를 수 있습니다.
    -   현재까지 몇 명이 참여 신청했는지 실시간으로 확인할 수 있습니다.
    -   참여 신청을 한 멤버의 개인 캘린더에 해당 일정이 자동으로 추가됩니다.

### 3.3. 편의 기능

#### 최적 시간 추천 (Smart Time Recommendation)

-   **목적**: '대상자 지정' 일정 생성 시, 참여 가능한 인원이 가장 많은 시간을 추천해주는 기능입니다.
-   **동작 방식**:
    1.  일정 생성자가 대상자 그룹을 지정합니다.
    2.  시스템은 대상자 및 장소의 시간표 데이터를 종합하여 분석합니다.
    3.  생성자는 토글을 통해 분석에 포함할 데이터 소스를 선택할 수 있습니다.
        -   **학교 시간표 (선택)**
        -   **개인 일정 (선택)**
        -   **장소 예약 현황 (선택, 장소 지정 시)**
    4.  분석 결과를 바탕으로, 시간대별로 '가능 인원'과 '불가능 인원' 수를 시각적으로 보여주어 최적의 일정 수립을 돕습니다.

#### 채널 게시글 연동 (Channel Post Integration)

-   **목적**: 캘린더 일정을 채널 게시글과 연동하여 멤버들의 접근성과 참여율을 높입니다.
-   **기능**:
    -   일정 생성 마지막 단계에서, 생성자는 자신이 작성 권한을 가진 채널을 선택하여 관련 게시글을 바로 작성할 수 있습니다.
    -   게시글은 다음과 같은 구조로 자동 생성됩니다.
        -   **상단**: 일정 제목, 시간, 장소 등 핵심 정보 요약
        -   **중간**: 생성자가 입력한 상세 내용
        -   **하단**: 일정 종류에 따른 액션 버튼 (예: `[불참 의사 밝히기]`, `[참여 신청하기]`)
    -   이 기능을 사용하지 않으면, 멤버들은 캘린더에 직접 들어가야만 일정에 대한 상호작용(불참, 신청 등)을 할 수 있습니다.

## 4. 장소 및 자원 관리 (Place & Resource Management)

특정 장소(예: 동아리방, 랩실, 회의실)의 예약 및 일정 관리를 위한 기능입니다. 장소는 그룹에 의해 관리되며, 다른 그룹은 승인을 통해 사용 권한을 얻거나 관리 주체가 될 수 있습니다.

### 4.1. 장소의 정의 및 최초 등록

-   **식별**: 장소는 `건물-방 번호`로 고유하게 식별됩니다. (예: `60주년 기념관-18203`)
-   **표시**: 사용자에게는 `건물-방 번호(별칭)` 형태로 표시됩니다. (예: `60주년 기념관-18203(AISC랩실)`)
-   **최초 등록**: 시스템에 장소를 등록하고자 하는 그룹의 관리자는 `건물`과 `방 번호`, `별칭`을 입력하여 장소를 생성할 수 있습니다. 등록이 완료되면, 해당 그룹은 그 장소의 **최초 관리 주체**가 됩니다.
    -   만약 다른 그룹이 이미 등록한 장소일 경우, 등록이 불가능하며 현재 관리 그룹을 안내합니다.

### 4.2. 장소 관리 주체의 역할

장소의 관리 주체인 그룹의 관리자는 다음 핵심 권한을 가집니다.

-   **장소 사용 그룹 승인**: 다른 그룹의 '장소 사용 그룹' 신청을 승인하거나 거부합니다.
-   **예약 관리**: 장소의 모든 예약 현황을 조회하고, 필요시 예약을 강제로 취소할 수 있습니다.
-   **예약 가능 시간 설정**: 주 단위 반복 또는 특정 날짜의 예약 가능/불가능 시간을 설정합니다.

### 4.3. 장소 사용 권한 획득 (장소 사용 그룹 되기)

다른 그룹이 관리하는 장소를 사용하고 싶은 그룹은 다음 절차를 따릅니다.

1.  **신청**: 장소를 사용하려는 그룹의 관리자가, 장소를 관리하는 그룹의 관리자에게 '장소 사용 그룹' 신청을 보냅니다.
2.  **승인**: 장소 관리자가 신청을 승인합니다.
3.  **권한 획득**: 승인이 완료되면,
    -   신청한 그룹의 워크스페이스 캘린더에 해당 **장소 캘린더가 추가**됩니다.
    -   이제 해당 그룹의 멤버들은 일정을 생성할 때 이 장소를 예약할 수 있게 됩니다.

### 4.4. 관리 주체 변경 (관리 권한 이전)

장소의 관리 주체 자체를 다른 그룹으로 이전할 수 있습니다.

1.  **신청**: 새로운 관리 주체가 되려는 그룹의 관리자가, **현재 관리 그룹의 관리자**에게 '장소 관리 권한 이전'을 신청합니다.
2.  **승인**: 현재 관리 그룹의 관리자가 이전을 승인합니다.
3.  **권한 이전**: 승인이 완료되면,
    -   신청한 그룹이 새로운 **관리 주체**가 됩니다.
    -   기존 관리 그룹은 **일반 '장소 사용 그룹'으로 역할이 변경**됩니다.
    -   이 과정에서, 기존 관리 그룹 및 다른 모든 '장소 사용 그룹'의 **장소 사용 권한은 그대로 유지**됩니다.

### 4.5. 일반 사용자의 기능

-   **장소 예약**: 자신의 그룹이 '장소 사용 그룹'으로 승인된 장소에 한해, 일정을 생성하며 해당 장소를 예약할 수 있습니다.
-   **예약 현황 조회**: 예약된 장소 캘린더를 통해 시간대별 예약 현황을 조회할 수 있습니다.
