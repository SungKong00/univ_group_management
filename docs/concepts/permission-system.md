# 권한 시스템 (Permission System)

그룹 내 사용자의 역할에 따라 차별화된 기능을 제공하는 시스템입니다.

## 개요

**기본 원리**: 사용자 → 역할 부여 → 역할별 기능 사용

실제 조직처럼 직책에 따라 권한이 달라집니다.

## 권한의 두 가지 범위

### 그룹 전체 권한
- **그룹 관리**: 그룹 정보 수정, 삭제
- **멤버 관리**: 초대, 강제 탈퇴, 역할 변경
- **채널 관리**: 채널 생성, 삭제, 설정 변경
- **모집 관리**: 모집 게시글 작성, 지원자 심사
- **캘린더 관리**: 공식 일정 생성, 장소 관리

### 채널별 권한
- **채널 보기**: 채널 존재 확인 및 입장
- **글 읽기**: 게시글과 댓글 조회
- **글 쓰기**: 게시글 작성
- **댓글 쓰기**: 댓글 달기
- **파일 업로드**: 파일 첨부

## 기본 역할 (시스템 역할)

모든 그룹에는 3가지 시스템 역할이 자동 생성됩니다.
**이름 / 우선순위 / 권한을 수정하거나 삭제할 수 없습니다** (플랫폼 안정성 위해)

| 역할 | 권한 | 특징 |
|------|------|------|
| **그룹장** | 모든 권한 | 소유권 이전 가능(추후) |
| **교수** | 그룹장과 동일 (MVP) | 향후 축소 가능 |
| **멤버** | 기본 참여 권한 | 채널별 실제 권한은 바인딩으로 결정 |

## 커스텀 역할

그룹장이 직접 생성하여 조직의 특수한 역할을 정의할 수 있습니다.
(예: MODERATOR, RECRUITMENT_MANAGER)

- 이름, 우선순위, 권한 자유롭게 설정 가능
- 나중에 권한을 추가/수정/삭제 가능

## 권한 확인 방식

**4단계 프로세스**:
1. 사용자의 그룹 멤버십 확인
2. 할당된 역할(시스템/커스텀) 파악
3. (채널 자원인 경우) ChannelRoleBinding으로 채널 권한 확인
4. **캐시 조회** → DB 조회 (성능 최적화)

## 채널 권한 바인딩

### 기본 2채널 (자동 템플릿)
그룹 생성 직후 자동 생성되는 **공지사항, 자유게시판**:
- 초기에 **그룹장/교수/멤버 템플릿** 자동 부여
- 즉시 사용 가능

### 사용자 정의 채널 (0 바인딩)
운영자가 이후 생성하는 채널:
- **초기: 권한 0개** (그룹장도 접근 불가)
- 반드시 **권한 매트릭스에서 권한 설정 필요**
- Permission-Centric 방식: "권한별로 허용할 역할" 지정

### 권한 설정 예시

| 권한 | 허용 역할 |
|------|---------|
| CHANNEL_VIEW | 그룹장, 멤버 |
| POST_READ | 그룹장, 멤버 |
| POST_WRITE | 그룹장 |
| COMMENT_WRITE | 그룹장 |

## 캘린더 권한 (통합)

캘린더 시스템은 기존 권한 체계에 통합하여 단순화합니다.

**추가된 권한**:
- `CALENDAR_MANAGE`: 공식 일정 생성/수정/삭제, 장소 관리 전체 권한

**멤버십 기반 접근** (별도 권한 불필요):
- **캘린더 조회**: 그룹 멤버면 가능
- **비공식 일정**: 모든 멤버가 생성 가능
- **장소 예약**: APPROVED 상태 + 멤버

([설계 결정사항](../backend/calendar-core-design.md#dd-cal-001-권한-통합-및-단순화))

## 관련 문서

- [채널 권한 상세](channel-permissions.md) - 채널별 권한 설정 방법
- [워크스페이스 & 채널](workspace-channel.md) - 조직 구조
- [캘린더 시스템](calendar-integration.md) - 캘린더 권한 통합
- [백엔드 권한 설계](../concepts/permission-system.md) - 기술 구현
- [권한 에러](../troubleshooting/permission-errors.md) - 문제 해결
